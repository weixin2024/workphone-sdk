(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["friendCircle"],{"33a6":function(e,t,i){"use strict";var s=i("966e"),n=i.n(s);n.a},7049:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-circle-send"},[i("div",{staticClass:"set-send-content scroll"},[i("div",{staticClass:"set-circle-type"},[i("span",{staticClass:"base-tips"},[e._v("朋友圈类型")]),i("el-radio-group",{staticClass:"can-not-select",attrs:{size:"medium"},model:{value:e.circleType,callback:function(t){e.circleType=t},expression:"circleType"}},[i("el-radio-button",{attrs:{label:"text"}},[e._v("纯文本")]),i("el-radio-button",{attrs:{label:"picture"}},[e._v("图片")]),i("el-radio-button",{attrs:{label:"video"}},[e._v("视频")]),i("el-radio-button",{attrs:{label:"link"}},[e._v("链接")])],1)],1),i("div",{staticClass:"set-circle-text"},[i("span",{staticClass:"base-tips can-not-select"},[e._v("输入文本内容")]),i("el-input",{staticStyle:{height:"auto",width:"50%"},attrs:{type:"textarea",placeholder:"这一刻的想法...",maxlength:"500","show-word-limit":"",autosize:{minRows:6,maxRows:6},resize:"none"},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}})],1),"link"!==e.circleType?i("div",{staticClass:"set-circle-other"},[i("span",{staticClass:"base-tips can-not-select",domProps:{textContent:e._s("上传文件")}}),"text"===e.circleType?i("el-upload",{staticClass:"el-upload-text",attrs:{action:"http://www.jjldkj.com:10089/fileUpload","list-type":"picture-card",disabled:""}},[i("i",{staticClass:"el-icon-plus"})]):e._e(),"picture"===e.circleType?i("el-upload",{staticClass:"set-image-ulrs",class:{hide:e.hideUpload},attrs:{action:"http://www.jjldkj.com:10089/fileUpload","list-type":"picture-card",accept:".jpg, .png, .jpeg",multiple:!0,limit:9,"file-list":e.imagesList,data:e.upData,"show-file-list":e.showFileList,"on-change":e.handleImageChange,"before-upload":e.beforeImageUpload,"on-success":e.handleImageSuccess,"on-error":e.handleImageError,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleImageRemove,"on-exceed":e.handleImageExceed}},[i("i",{staticClass:"el-icon-plus"})]):e._e(),"video"===e.circleType?i("el-upload",{class:{hide:e.hideVideoUpload},attrs:{action:"http://www.jjldkj.com:10089/fileUpload","list-type":"picture-card",accept:".mp4","file-list":e.videoList,multiple:!1,limit:1,data:e.upData,"show-file-list":e.showVideoList,"before-upload":e.beforeVideoUpload,"on-success":e.handleVideoSuccess,"on-error":e.handleVideoError},scopedSlots:e._u([{key:"file",fn:function(t){var s=t.file;return i("div",{},[i("video",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:s.url,alt:""}}),i("span",{staticClass:"el-upload-list__item-actions"},[i("span",{staticClass:"el-upload-list__item-preview",on:{click:function(t){return e.handlePictureCardPreview(s)}}},[i("i",{staticClass:"el-icon-zoom-in"})]),i("span",{staticClass:"el-upload-list__item-delete",on:{click:function(t){return e.handleVideoRemove(s)}}},[i("i",{staticClass:"el-icon-delete"})])])])}}],null,!1,1780581567)},[i("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})]):e._e(),i("div",{staticClass:"media-tip"},[i("i",{staticClass:"el-icon-info",staticStyle:{color:"#f5a623"}}),i("span",{staticStyle:{"margin-left":"5px",color:"#909399"},domProps:{textContent:e._s(e.circleTypeTip[e.circleType])}})])],1):e._e(),"link"===e.circleType?[i("div",{staticClass:"set-circle-link"},[i("span",{staticClass:"base-tips"},[e._v("请输入图片地址")]),i("el-input",{attrs:{placeholder:"请输入图片地址",maxlength:"200",minlength:"12",clearable:""},model:{value:e.linkImg,callback:function(t){e.linkImg=t},expression:"linkImg"}})],1),i("div",{staticClass:"set-circle-link"},[i("span",{staticClass:"base-tips"},[e._v("请输入链接标题")]),i("el-input",{attrs:{type:"textarea",placeholder:"请输入链接标题",maxlength:"200","show-word-limit":"",autosize:{minRows:6,maxRows:6},resize:"none"},model:{value:e.linkTitle,callback:function(t){e.linkTitle=t},expression:"linkTitle"}})],1),i("div",{staticClass:"set-circle-link"},[i("span",{staticClass:"base-tips"},[e._v("请输入链接地址")]),i("el-input",{attrs:{placeholder:"请输入链接地址",maxlength:"200",minlength:"12",clearable:""},model:{value:e.linkUrl,callback:function(t){e.linkUrl=t},expression:"linkUrl"}})],1)]:e._e(),i("div",{staticClass:"set-circle-comment"},[i("span",{staticClass:"base-tips can-not-select"},[e._v("输入评论(可选)")]),i("el-input",{staticStyle:{height:"auto",width:"50%"},attrs:{type:"textarea",placeholder:"如果有需要，请输入评论",maxlength:"300","show-word-limit":"",autosize:{minRows:6,maxRows:6},resize:"none"},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}})],1),i("div",{staticClass:"visible-type"},[i("span",{staticClass:"base-tips"},[e._v("谁可以看")]),i("el-radio-group",{staticClass:"can-not-select",attrs:{size:"medium"},model:{value:e.visibleType,callback:function(t){e.visibleType=t},expression:"visibleType"}},[i("el-radio-button",{attrs:{label:"0"}},[e._v("公开")]),i("el-radio-button",{attrs:{disabled:"timing"===e.sendRadio,label:"1"}},[e._v("私密")]),i("el-radio-button",{attrs:{disabled:"timing"===e.sendRadio,label:"2"}},[e._v("部分可见")]),i("el-radio-button",{attrs:{label:"3"}},[e._v("不给谁看")])],1),e.visibleType>1?i("el-button",{staticStyle:{padding:"5px","margin-left":"5px"},attrs:{circle:"",icon:"el-icon-setting",size:"small",type:"success"},on:{click:function(){return e.friendsDialogVisible=!0}}}):e._e()],1)],2),i("div",{staticClass:"group-send-operation"},[i("el-radio-group",{model:{value:e.sendRadio,callback:function(t){e.sendRadio=t},expression:"sendRadio"}},[i("el-radio",{attrs:{label:"rightNow"}},[e._v("立即开始")]),i("el-radio",{attrs:{label:"timing"}},[e._v("定时开始")]),i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间",clearable:"",size:"small",disabled:"rightNow"===e.sendRadio},model:{value:e.refTime,callback:function(t){e.refTime=t},expression:"refTime"}})],1),i("el-button",{staticClass:"group-send-operation-btn",attrs:{size:"small",type:"primary",loading:e.loading,disabled:e.loading},on:{click:e.postSNSNewsTask}},[e._v("确认发送")])],1),i("el-dialog",{staticClass:"dialog-visible",attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},["picture"===e.circleType?i("img",{staticClass:"circle-send-dialog",attrs:{width:"100%",src:e.imageUrl,alt:""}}):"video"===e.circleType?i("video",{staticClass:"circle-send-dialog",attrs:{src:e.video,controls:""}}):e._e()]),i("el-dialog",{staticClass:"friends-dialog",attrs:{title:"选择好友",visible:e.friendsDialogVisible,"before-close":e.closeFriendsDialog},on:{"update:visible":function(t){e.friendsDialogVisible=t}}},[i("div",{staticClass:"friends-list"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.onlyShowChose?e.friendsChose[e.currentPage-1]:e.tableData[e.currentPage-1],stripe:"",border:"",height:"60"}},[i("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),i("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),i("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),i("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),i("el-table-column",{attrs:{label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.formatLabelId(t.row.LabelIds),(function(t,s){return i("el-tag",{key:s,staticClass:"label",domProps:{textContent:e._s(e.$options.filters.labelFilter(t,e.labels))}})}))}}])}),i("el-table-column",{attrs:{width:"180px"},scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:e.friends.length===e.friendIdChose.length?"success":"info"},on:{click:e.choseAllFriends}},[e._v("全选")]),i("el-button",{attrs:{size:"mini",type:e.allCheckState2?"success":"info"},on:{click:e.choseAllOfPage}},[e._v("选本页")]),e._e()]}},{key:"default",fn:function(t){return[i("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(t.row)}}})]}}])})],1),i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[50,100,150,200],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),i("div",{staticClass:"operation-box"},[i("el-input",{staticClass:"search-input",attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"请输入内容",maxlength:"20","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),i("div",{staticClass:"send-labels"},[0===e.labels.length?i("span",{domProps:{textContent:e._s("没有标签或者刷新通讯录")}}):i("div",{staticClass:"labels scroll"},e._l(e.labels,(function(t,s){return i("el-tag",{key:s,staticClass:"label",domProps:{textContent:e._s(t.LabelName)},on:{click:function(i){return e.showLabel(t)}}})})),1)]),i("div",{staticClass:"operation-btns"},[i("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"仅显示已选中的"},model:{value:e.onlyShowChose,callback:function(t){e.onlyShowChose=t},expression:"onlyShowChose"}}),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.friendsDialogVisible=!1}}},[e._v("确认")])],1)],1)]),i("el-dialog",{staticClass:"filter-dialog",attrs:{title:"标签好友",visible:e.dialogSearchVisible,"before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchContent,stripe:"",border:"",height:"60"}},[i("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),i("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),i("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),i("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),i("el-table-column",{attrs:{label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.formatLabelId(t.row.LabelIds),(function(t,s){return i("el-tag",{key:s,staticClass:"label",domProps:{textContent:e._s(e.$options.filters.labelFilter(t,e.labels))}})}))}}])}),i("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:e.allCheckState?"success":"info"},on:{click:e.choseAllSearchContent}},[e._v("全选")]),e._e()]}},{key:"default",fn:function(t){return[i("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(i){return e.choseFriend(t.row)}}})]}}])})],1)],1)],1)},n=[],a=(i("99af"),i("a623"),i("4de4"),i("c975"),i("a15b"),i("fb6a"),i("a434"),i("d3b7"),i("ac1f"),i("25f0"),i("841c"),i("1276"),i("b85c")),l=i("5530"),r=i("2f62"),o={name:"FriendCircleSend",data:function(){return{circleTypes:[{label:"纯文本",value:"text"},{label:"图片",value:"picture"},{label:"视频",value:"video"},{label:"链接",value:"link"}],circleType:"text",circleTypeTip:{text:"纯文本模式，不能上传图片或视频！",picture:"只能上传jpg/png文件，且不超过2MB",video:"只能上传mp4文件，且不超过10秒",link:""},sendRadio:"rightNow",refTime:(new Date).getTime(),visibleType:0,text:"",onlyShowChose:!1,hideUpload:!1,showFileList:!0,imagesList:[],showVideoList:!0,hideVideoUpload:!1,videoList:[],upData:{myfile:""},imageUrl:"",dialogVisible:!1,imageUrls:[],video:"",comment:"",linkUrl:"http://xiaohua.zol.com.cn/detail60/59426.html",linkImg:"https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture",linkTitle:"看一看，乐一乐",friendsDialogVisible:!1,currentPage:1,pageSize:50,sending:!1,friendIdChose:[],friendsChose:[],tags:[],search:"",searchContent:[],dialogSearchVisible:!1,loading:!1}},computed:Object(l["a"])(Object(l["a"])({},Object(r["b"])({labels:"nedb/circleLabels",friends:"nedb/circleFriends",currentWechats:"currentWechats"})),{},{currentWeChatId:function(){return this.currentWechats["circleSend"]},totalPage:function(){return this.friends.length},tableData:function(){for(var e=[],t=this.pageSize,i=0;i<this.friends.length;i+=t)e.push(this.friends.slice(i,i+t));return e},allCheckState:function(){var e=this,t=this.searchContent.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}));return t},allCheckState2:function(){var e=this,t=this.tableData[this.currentPage-1];return!!t&&t.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}))}}),watch:{currentWeChatId:function(e){this.visibleType=0,this.currentPage=1,this.friendIdChose=[]},onlyShowChose:function(e){var t=this;if(e){var i=[];i=this.friends.filter((function(e){return t.friendIdChose.indexOf(e.FriendId)>=0}));for(var s=[],n=this.pageSize,a=0;a<i.length;a+=n)s.push(i.slice(a,a+n));this.friendsChose=s}}},methods:{transformTime:function(e){var t=new Date(e),i=t.getFullYear()+"-",s=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",n=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",a=(t.getHours()<10?"0"+t.getHours():t.getHours())+":",l=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),r=i+s+n+a+l;return r},postSNSNewsTask:function(){var e=this;if(this.currentWeChatId)if("text"!==this.circleType||this.text)if("picture"!==this.circleType||0!==this.imageUrls.length)if("video"!==this.circleType||this.video)if("link"!==this.circleType||this.linkUrl&&this.linkImg&&this.linkTitle){var t={Type:this.visibleType,Labels:"",Friends:""};if("timing"!==this.sendRadio||"1"!==this.visibleType&&"2"!==this.visibleType){if("2"===this.visibleType||"3"===this.visibleType){if(0===this.friendIdChose.length)return void this.$message.warning("请至少选择一个好友！");var i=this.friendIdChose.join(",");t.Friends=i}var s={};switch(this.circleType){case"picture":s={Type:2,Content:this.imageUrls};break;case"video":s={Type:3,Content:[this.video]};break;case"link":s={Type:0,Content:[this.linkUrl,this.linkTitle,this.linkImg]};break;default:break}this.$confirm("即将发送朋友圈, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if("rightNow"===e.sendRadio){var i={WeChatId:e.currentWeChatId,Content:e.text,Attachment:s,Comment:e.comment,Visible:t};e.$store.dispatch("websocket/PostSNSNewsTask",i)}else{var n={tasktype:2,state:1,wechatId:e.currentWeChatId,execute_time:e.transformTime(e.refTime),content:e.text,comment:e.comment,restype:s.Type?s.Type:1};s.Type&&(n.attachtype=s.Type,n.attachtcontent=s.Content.join(",")),"3"===e.visibleType&&(n.whoinvisible=t.Friends),e.$store.dispatch("websocket/AddTaskTimeInfo",n)}e.loading=!0,setTimeout((function(){e.loading=!1}),3e3)})).catch((function(){e.$message.info("已取消删除")}))}else this.$message.warning("定时发朋友圈,只能设置 公开 或 不给谁看!")}else this.$message.warning("请设置链接参数!");else this.$message.warning("请设置视频!");else this.$message.warning("请设置图片!");else this.$message.warning("请设置文本内容!");else this.$message.warning("请选择微信!")},formatLabelId:function(e){var t=[];return e&&(t=e.split(",")),t},handleImageExceed:function(e,t){this.$message.warning("当前限制选择 9 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},handleImageChange:function(e,t){9===t.length&&(this.showFileList=!0,this.hideUpload=!0)},beforeImageUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type,i=e.size/1024/1024<2;return t||this.$message.warning("上传图片只能是 JPG|PNG 格式!"),i||this.$message.warning("上传图片大小不能超过 2MB!"),this.upData.myfile=e,t&&i},handleImageSuccess:function(e,t,i){var s,n=Object(a["a"])(i);try{for(n.s();!(s=n.n()).done;){var l=s.value;l.response&&(l.url=l.response.data.url)}}catch(r){n.e(r)}finally{n.f()}this.imagesList=i,this.imageUrls.push(e.data.url)},handleImageError:function(e,t){this.$alert(e,"文件上传失败",{type:"error"}),this.hideUpload=!1},handleImageRemove:function(e,t){var i=this.imageUrls.indexOf(e.response.data.url);this.imageUrls.splice(i,1),this.hideUpload=!1,this.imagesList=t},beforeVideoUpload:function(e){var t="video/mp4"===e.type,i=e.size/1024/1024<20;return t||this.$message.warning("上传视频只能是 MP4 格式!"),i||this.$message.warning("上传视频大小不能超过 20MB!"),t&&i&&(this.upData.myfile=e),t&&i},handleVideoSuccess:function(e,t,i){console.log("视频上传成功");var s,n=Object(a["a"])(i);try{for(n.s();!(s=n.n()).done;){var l=s.value;l.response&&(l.url=l.response.data.url)}}catch(r){n.e(r)}finally{n.f()}this.showVideoList=!0,this.hideVideoUpload=!0,this.videoList=i,this.video=e.data.url},handleVideoError:function(e,t){this.$alert(e,"文件上传失败",{type:"error"}),this.hideVideoUpload=!1,this.showVideoList=!1},handleVideoRemove:function(e,t){this.video="",this.videoList=t,this.hideVideoUpload=!1,this.showVideoList=!1},handlePictureCardPreview:function(e){"picture"===this.circleType?this.imageUrl=e.url:this.video=e.url,this.dialogVisible=!0},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},indexMethod:function(e){return e+1},searchChange:function(){var e=[],t=this.search;if(t){var i,s=Object(a["a"])(this.friends);try{for(s.s();!(i=s.n()).done;){var n=i.value;(n.FriendNick&&n.FriendNick.indexOf(t)>=0||n.Memo&&n.Memo.indexOf(t)>=0)&&e.push(n)}}catch(l){s.e(l)}finally{s.f()}this.searchContent=e,this.dialogSearchVisible=!0}},showLabel:function(e){var t,i=e.LabelId.toString(),s=[],n=Object(a["a"])(this.friends);try{for(n.s();!(t=n.n()).done;){var l=t.value;if(l.LabelIds){var r=l.LabelIds.split(",");r.indexOf(i)>=0&&s.push(l)}}}catch(o){n.e(o)}finally{n.f()}s.length>0?(this.searchContent=s,this.dialogSearchVisible=!0):this.$message.warning("没有数据")},closeFriendsDialog:function(e){this.search="",this.onlyShowChose=!1,e()},closeDialog:function(e){this.searchContent=[],e()},choseFriend:function(e){var t=e.FriendId,i=this.friendIdChose.indexOf(t);i>=0?this.friendIdChose.splice(i,1):this.friendIdChose.push(t)},choseAllFriends:function(){if(this.friendIdChose.length===this.friends.length)this.friendIdChose=[];else{var e,t=Object(a["a"])(this.friends);try{for(t.s();!(e=t.n()).done;){var i=e.value;-1===this.friendIdChose.indexOf(i.FriendId)&&this.friendIdChose.push(i.FriendId)}}catch(s){t.e(s)}finally{t.f()}}},choseAllOfPage:function(){var e=this.tableData[this.currentPage-1];if(this.allCheckState2){var t,i=Object(a["a"])(e);try{for(i.s();!(t=i.n()).done;){var s=t.value,n=s.FriendId,l=this.friendIdChose.indexOf(n);this.friendIdChose.splice(l,1)}}catch(h){i.e(h)}finally{i.f()}}else{var r,o=Object(a["a"])(e);try{for(o.s();!(r=o.n()).done;){var c=r.value,d=c.FriendId,u=this.friendIdChose.indexOf(d);u<0&&this.friendIdChose.push(d)}}catch(h){o.e(h)}finally{o.f()}}},choseAllSearchContent:function(){if(this.allCheckState){var e,t=Object(a["a"])(this.searchContent);try{for(t.s();!(e=t.n()).done;){var i=e.value,s=i.FriendId,n=this.friendIdChose.indexOf(s);this.friendIdChose.splice(n,1)}}catch(u){t.e(u)}finally{t.f()}}else{var l,r=Object(a["a"])(this.searchContent);try{for(r.s();!(l=r.n()).done;){var o=l.value,c=o.FriendId,d=this.friendIdChose.indexOf(c);d<0&&this.friendIdChose.push(c)}}catch(u){r.e(u)}finally{r.f()}}}}},c=o,d=(i("c176"),i("2877")),u=Object(d["a"])(c,s,n,!1,null,"4cad8688",null);t["default"]=u.exports},"730e":function(e,t,i){},7515:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticClass:"circle-my scroll"},[e.circleCount>0?[e._l(e.count,(function(t,n){return s("li",{key:n,class:{circle:e.currentCircles[t-1]}},[e.currentCircles[t-1]?[e.currentCircles[t-1].Content.Text?s("div",{staticClass:"circle-text",domProps:{textContent:e._s(e.currentCircles[t-1].Content.Text)}}):e._e(),e.currentCircles[t-1].Content.Link?s("div",{staticClass:"circle-link",attrs:{title:"点击打开链接"},on:{click:function(i){return e.openLink(e.currentCircles[t-1])}}},[e.currentCircles[t-1].Content.Images?s("img",{attrs:{src:e.currentCircles[t-1].Content.Images[0].ThumbImg,alt:"这是link"}}):s("span",{staticClass:"circle-link-description",domProps:{textContent:e._s("无效链接")}}),s("span",{staticClass:"circle-link-description",domProps:{textContent:e._s(e.currentCircles[t-1].Content.Link.Description)}})]):e.currentCircles[t-1].Content.Images?s("div",{staticClass:"circle-img"},e._l(e.currentCircles[t-1].Content.Images,(function(i,n){return s("div",{key:n,staticClass:"img-div"},[i.ThumbImg?s("img",{attrs:{src:i.ThumbImg,alt:"图片地址错误"}}):s("img",{attrs:{src:i.ThumbImg,alt:"点击获取缩略图"},on:{click:function(i){return e.pullCircleDetailTask(e.currentCircles[t-1])}}})])})),0):e.currentCircles[t-1].Content.Video?s("div",{staticClass:"circle-video"},[s("video",{staticClass:"video",attrs:{controls:""}},[s("source",{attrs:{src:e.currentCircles[t-1].Content.Video.Url,type:"video/mp4"}})])]):e._e(),s("div",{staticClass:"time-operation"},[s("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.currentCircles[t-1].PublishTime))}}),s("div",[s("el-button",{attrs:{type:"warning ",size:"small",icon:"el-icon-delete"},on:{click:function(i){return e.deleteSNSNewsTask(e.currentCircles[t-1])}}},[e._v("删除")]),s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-star-off"},on:{click:function(i){return e.likeCircle(e.currentCircles[t-1])}}},[e._v("点赞")]),s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(i){return e.circleCommentReplyTask(e.currentCircles[t-1])}}},[e._v("评论")]),s("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:function(i){return e.triggerCirclePushTask(e.currentCircles[t-1])}}},[e._v("刷新")])],1)]),e.currentCircles[t-1].Likes?s("div",{staticClass:"likes-box"},[s("i",{staticClass:"fa fa-heart-o",attrs:{"aria-hidden":"true"}}),s("div",e._l(e.currentCircles[t-1].Likes,(function(t,n){return s("div",{key:n},[s("img",{attrs:{src:e.currentfriendsMap[t.FriendId]?e.currentfriendsMap[t.FriendId].Avatar:i("f067")}})])})),0)]):e._e(),e.currentCircles[t-1].Comments?s("div",{staticClass:"comment-box"},e._l(e.currentCircles[t-1].Comments,(function(n,a){return s("div",{key:a,staticClass:"every-comment"},[s("img",{attrs:{src:e.currentfriendsMap[n.FromWeChatId]?e.currentfriendsMap[n.FromWeChatId].Avatar:i("f067")}}),s("div",{staticClass:"comment-info"},[s("div",{staticClass:"name-time"},[s("span",{staticClass:"ellipsis",domProps:{textContent:e._s(e.currentfriendsMap[n.FromWeChatId]?e.currentfriendsMap[n.FromWeChatId].FriendNick:n.FromWeChatId)}}),s("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(n.PublishTime))}})]),s("div",{staticClass:"reply-1"},[s("div",{staticClass:"reply-to-friend",attrs:{title:n.Content}},[n.ToWeChatId?s("span",[e._v(" 回复 "),s("span",{staticClass:"reply-friend-name",domProps:{textContent:e._s(e.currentfriendsMap[n.ToWeChatId]?e.currentfriendsMap[n.ToWeChatId].FriendNick:n.ToWeChatId)}}),e._v(" : ")]):e._e(),s("span",{staticClass:"comment-content",domProps:{textContent:e._s(n.Content)}})]),n.FromWeChatId===e.currentCircles[t-1].WeChatId?s("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true",title:"删除"},on:{click:function(i){return e.circleCommentDeleteTask(e.currentCircles[t-1],n)}}}):s("i",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true",title:"回复"},on:{click:function(i){return e.circleCommentReplyTask(e.currentCircles[t-1],n)}}})])])])})),0):e._e()]:e._e()],2)})),e.loading?s("li",{staticClass:"li-loading"},[s("i",{staticClass:"el-icon-loading"}),e._v("加载中... ")]):e._e(),e.noMore?s("li",{staticClass:"li-btn"},[s("el-button",{staticStyle:{margin:"10px"},attrs:{disabled:e.pullFriendCircle,size:"small",type:"primary"},on:{click:e.getMore}},[e._v("获取更多")])],1):e._e()]:e._e()],2)},n=[],a=(i("a9e3"),i("5530")),l=i("2f62"),r={name:"FriendCircleMy",data:function(){return{loading:!1,count:5,pullFriendCircle:!1}},computed:Object(a["a"])(Object(a["a"])({},Object(l["b"])({currentWechats:"currentWechats",friendsMap:"nedb/friendsMap",currentCircles:"nedb/currentCircles"})),{},{currentfriendsMap:function(){var e=this.currentWechats["circleMy"];return e&&this.friendsMap[e]?this.friendsMap[e]:{}},circleCount:function(){return this.currentCircles.length},noMore:function(){return this.count>=this.circleCount},currentWeChatId:function(){return this.currentWechats["circleMy"]}}),watch:{currentWeChatId:function(e){this.count=5}},methods:{load:function(){var e=this;this.count<this.circleCount&&!this.loading&&(this.loading=!0,setTimeout((function(){e.loading=!1,e.count++}),1e3))},getMore:function(){var e=this;this.pullFriendCircle=!0;var t=this.currentCircles.length,i=t>0?this.currentCircles[t-1].PublishTime:0,s={wechatId:this.currentWeChatId,friendId:this.currentWeChatId,startTime:Number(i),count:5};this.$store.dispatch("websocket/PullFriendCircleTask",s),setTimeout((function(){e.pullFriendCircle=!1}),1e4)},openLink:function(e){var t=e.Content.Link.Url,i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("target","_blank"),i.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(i),i.click()},deleteSNSNewsTask:function(e){var t=this;this.$confirm("确认删除该朋友圈 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$message.success("已提交任务"),t.$store.dispatch("websocket/DeleteSNSNewsTask",e)})).catch((function(){t.$message.info("已取消删除")}))},likeCircle:function(e){this.$message.info("点赞任务已发出！"),this.$store.dispatch("websocket/CircleLikeTask",e)},triggerCirclePushTask:function(e){this.$message.info("任务已经下发!"),this.$store.dispatch("websocket/TriggerCirclePushTask",e)},pullCircleDetailTask:function(e){this.$message.info("任务已经下发!"),this.$store.dispatch("websocket/PullCircleDetailTask",e)},circleCommentDeleteTask:function(e,t){var i=this;e.currentComment=t,this.$confirm("确认删除该评论 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.$message.info("已提交任务"),i.$store.dispatch("websocket/CircleCommentDeleteTask",e)})).catch((function(){i.$message.info("已取消删除")}))},circleCommentReplyTask:function(e,t){var i=this;t&&(e.currentComment=t),this.$prompt("请输入评论内容","评论",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"评论字数1-500"}).then((function(t){var s=t.value;i.$message.info("任务已经下发！"),e.value=s,i.$store.dispatch("websocket/CircleCommentReplyTask",e)})).catch((function(){i.$message.info("取消任务！")}))}}},o=r,c=(i("e157"),i("2877")),d=Object(c["a"])(o,s,n,!1,null,"313593e0",null);t["default"]=d.exports},"83d3":function(e,t,i){"use strict";var s=i("730e"),n=i.n(s);n.a},"8c1c":function(e,t,i){},"966e":function(e,t,i){},ac17:function(e,t,i){},bc3b:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"friend-circle-log"},[i("el-table",{staticClass:"box-table",staticStyle:{width:"100%"},attrs:{data:e.tableData[e.currentPage-1],border:"",stripe:"",height:"60px"}},[i("el-table-column",{attrs:{label:"任务类型",prop:"MsgType",filters:e.msgTypes,"filter-method":e.filterMsgType}}),i("el-table-column",{attrs:{label:"任务时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(t.row.TaskId))}})]}}])}),i("el-table-column",{attrs:{label:"任务结果",prop:"result",formatter:e.resultFormatter,filters:e.results,"filter-method":e.filterResult}})],1),i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[50,100,150,200],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),i("el-dialog",{staticClass:"log-dialog",attrs:{title:"朋友圈定时任务日志","before-close":e.handleCloseCircleDilog,visible:e.taskTimeDialogCircle},on:{"update:visible":function(t){e.taskTimeDialogCircle=t}}},[i("task-time-info")],1)],1)},n=[],a=(i("fb6a"),i("5530")),l=i("2f62"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"task-time-info"},[i("el-table",{staticClass:"task-time-info-table",staticStyle:{width:"100%"},attrs:{data:e.groupSendLog,stripe:"",height:"60px"}},[i("el-table-column",{attrs:{label:"任务类型",filters:e.taskTypes,prop:"tasktype","filter-method":e.filterTaskTypes},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.tasktypeMap[t.row.tasktype])}})]}}])}),i("el-table-column",{attrs:{label:"消息类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.restypeMap[t.row.restype])}})]}}])}),i("el-table-column",{attrs:{prop:"content",label:"消息内容"}}),i("el-table-column",{attrs:{label:"当前状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(0===t.row.state?"发送成功":"发送中")}})]}}])}),i("el-table-column",{attrs:{prop:"execute_time",label:"开始时间"}}),i("el-table-column",{attrs:{label:"结束时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{domProps:{textContent:e._s(e.$options.filters.transformTime2Minute(t.row.createTime))}})]}}])})],1)],1)},o=[],c={name:"TaskTimeInfo",data:function(){return{tasktypeMap:{1:"PC群发消息",2:"PC发朋友圈",3:"删除好友",4:"删除群聊",5:"群发群消息",6:"按标签群发",7:"发朋友圈",8:"批量加好友"},restypeMap:{Text:1,Picture:2,Voice:3,Video:4,Link:6,WeApp:13,1:"文本",2:"图片",3:"语音",4:"视频",6:"链接",13:"小程序"},taskTypes:[{text:"群发好友",value:1},{text:"群发群",value:5},{text:"发朋友圈",value:2}]}},computed:Object(a["a"])({},Object(l["b"])({groupSendLog:"nedb/groupSendLog"})),methods:{filterTaskTypes:function(e,t,i){var s=i["property"];return t[s]===e}}},d=c,u=(i("83d3"),i("2877")),h=Object(u["a"])(d,r,o,!1,null,"34c518a2",null),p=h.exports,f={name:"FriendCircleLog",data:function(){return{dialogTableVisible:!1,msgTypes:[{text:"点赞",value:"CircleLikeTask"},{text:"评论",value:"CircleCommentReplyTask"},{text:"删除评论",value:"CircleCommentDeleteTask"},{text:"删除朋友圈",value:"DeleteSNSNewsTask"},{text:"发朋友圈",value:"PostSNSNewsTask"}],results:[{text:"成功",value:1},{text:"失败",value:2},{text:"执行中",value:0}],currentPage:1,pageSize:50}},components:{TaskTimeInfo:p},computed:Object(a["a"])(Object(a["a"])({},Object(l["b"])({currentWechats:"currentWechats",taskTimeDialogCircle:"taskTimeDialogCircle",friendCircleLog:"nedb/friendCircleLog"})),{},{totalPage:function(){return this.tableData.length},tableData:function(){for(var e=[],t=this.pageSize,i=0;i<this.friendCircleLog.length;i+=t)e.push(this.friendCircleLog.slice(i,i+t));return e},currentWeChatId:function(){var e=this.currentWechats["circleLog"];return e}}),watch:{currentWeChatId:function(){this.currentPage=1}},methods:{handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},resultFormatter:function(e,t){var i={0:"执行中",1:"成功",2:"失败"};return i[e.result]},filterMsgType:function(e,t,i){var s=i["property"];return t[s]===e},filterResult:function(e,t,i){return t.result===e},handleCloseCircleDilog:function(e){this.$store.commit("SET_TASK_TIME_DIALOG_CIRLCE",!1)}}},m=f,g=(i("33a6"),Object(u["a"])(m,s,n,!1,null,"54be1657",null));t["default"]=g.exports},c176:function(e,t,i){"use strict";var s=i("8c1c"),n=i.n(s);n.a},e157:function(e,t,i){"use strict";var s=i("ac17"),n=i.n(s);n.a}}]);