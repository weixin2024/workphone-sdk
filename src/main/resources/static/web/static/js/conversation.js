(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["conversation"],{"0591":function(e,t,n){e.exports=n.p+"static/img/tool-bar-qr-code-wx.svg"},"05a6":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n(e.$store.getters["currentNavs"][e.$route.name],{tag:"component"})],1)},r=[],a=(n("d3b7"),function(){return n.e("tools").then(n.bind(null,"fed8"))}),s=function(){return n.e("tools").then(n.bind(null,"48fc"))},o=function(){return n.e("tools").then(n.bind(null,"853f"))},c=function(){return n.e("tools").then(n.bind(null,"5463"))},l=function(){return n.e("tools").then(n.bind(null,"b012"))},d=function(){return n.e("tools").then(n.bind(null,"e8fa"))},u=function(){return n.e("tools").then(n.bind(null,"818d"))},h=function(){return n.e("tools").then(n.bind(null,"ed75"))},f=function(){return n.e("tools").then(n.bind(null,"40e8"))},m=function(){return n.e("tools").then(n.bind(null,"3d0b"))},p=function(){return n.e("tools").then(n.bind(null,"f402"))},C=function(){return n.e("tools").then(n.bind(null,"d49b"))},b={data:function(){return{}},components:{addFriend:a,addFriendAuto:s,searchPhones:o,autoHi:c,autoReply:d,autoTask:l,clearFans:u,newFriend:h,phoneManagement:f,qrCode:m,takeLabels:p,friendsFilter:C}},g=b,D=n("2877"),v=Object(D["a"])(g,i,r,!1,null,"51657c34",null);t["default"]=v.exports},"0b17":function(e,t,n){e.exports=n.p+"static/img/tool-bar-link.svg"},"0c22":function(e,t,n){},"10e5":function(e,t,n){e.exports=n.p+"static/img/tool-bar-voice.svg"},"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"1a0b":function(e,t,n){},"22f8":function(e,t,n){e.exports=n.p+"static/img/tool-bar-gh.svg"},"2ca0":function(e,t,n){"use strict";var i=n("23e7"),r=n("06cf").f,a=n("50c4"),s=n("5a34"),o=n("1d80"),c=n("ab13"),l=n("c430"),d="".startsWith,u=Math.min,h=c("startsWith"),f=!l&&!h&&!!function(){var e=r(String.prototype,"startsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!f&&!h},{startsWith:function(e){var t=String(o(this));s(e);var n=a(u(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return d?d.call(t,i,n):t.slice(n,n+i.length)===i}})},"2e12":function(e,t,n){e.exports=n.p+"static/img/tool-bar-manager.svg"},3298:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n(e.$store.getters["currentNavs"][e.$route.name],{tag:"component"})],1)},r=[],a=(n("d3b7"),function(){return n.e("friendCircle").then(n.bind(null,"bc3b"))}),s=function(){return n.e("friendCircle").then(n.bind(null,"7515"))},o=function(){return n.e("friendCircle").then(n.bind(null,"7049"))},c={data:function(){return{}},components:{circleLog:a,circleMy:s,circleSend:o}},l=c,d=n("2877"),u=Object(d["a"])(l,i,r,!1,null,"10740076",null);t["default"]=u.exports},"3d39":function(e,t,n){e.exports=n.p+"static/img/tool-bar-qr-room.svg"},4132:function(e,t,n){},"456b":function(e,t,n){},"4c31":function(e,t,n){e.exports=n.p+"static/img/tool-bar-expression.svg"},"513f":function(e,t,n){},"54d2":function(e,t,n){e.exports=n.p+"static/img/tool-bar-history.svg"},"55f4":function(e,t,n){},"57ad":function(e,t,n){e.exports=n.p+"static/img/tool-bar-red-envelopes.svg"},"5a34":function(e,t,n){var i=n("44e7");e.exports=function(e){if(i(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5e89":function(e,t,n){var i=n("861d"),r=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&r(e)===e}},"63c1":function(e,t,n){e.exports=n.p+"static/img/tool-bar-name-card.svg"},"68a9":function(e,t,n){"use strict";var i=n("513f"),r=n.n(i);r.a},"6f04":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-conversation"},[n("conversation-friends"),n("conversation-chats"),n("conversation-tools")],1)},r=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-chats"},[n("div",{staticClass:"chats-title"},[e.currentFriend.Avatar?n("img",{staticClass:"avatar",attrs:{src:e.currentFriend.Avatar,alt:"头像"}}):e._e(),n("span",{staticClass:"nick-name ellipsis",domProps:{textContent:e._s(e.currentFriend.NickName||e.currentFriend.FriendNick)}}),e.currentFriend.MemberList?n("div",{staticClass:"members-number",domProps:{textContent:e._s("("+e.currentFriend.MemberList.length+")")}}):e._e(),e.currentFriend.Gender?n("div",{staticClass:"gender",domProps:{textContent:e._s(e.currentFriend.Gender)}}):e._e(),e.currentFriend.Province?n("div",{staticClass:"address",domProps:{textContent:e._s(e.currentFriend.Province)}}):e._e(),e.currentFriend.City?n("div",{staticClass:"address",domProps:{textContent:e._s(e.currentFriend.City)}}):e._e()]),n("div",{staticClass:"chats-content"},[n("show-chats",{staticClass:"show-chats"}),n("div",{staticClass:"input-window"},[n("tools-bar"),n("answer-window")],1)],1),n("div",{staticClass:"chats-bottom"},[e._v("按ctrl + enter 换行")])])},s=[],o=n("5530"),c=n("2f62"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tool-bar can-not-select"},[i("div",{staticClass:"tool-start"},[i("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover"}},[i("div",{staticClass:"scroll",staticStyle:{height:"210px","overflow-y":"scroll"}},[i("img",{staticClass:"qq-face",attrs:{src:"expression/qqface.png",usemap:"#qqMap"}}),i("map",{attrs:{name:"qqMap"}},e._l(105,(function(t,n){return i("area",{key:n,attrs:{shape:"rect",coords:n%15*25+", "+25*parseInt(n/15)+", "+25*(n%15+1)+", "+25*(parseInt(n/15)+1),title:e.expressionMap[n]},on:{click:function(t){return e.selectExpression(n)}}})})),0),i("img",{attrs:{src:"expression/emoji.png",usemap:"#emojiMap"}}),i("map",{attrs:{name:"emojiMap"}},e._l(177,(function(t,n){return i("area",{key:n,attrs:{shape:"rect",coords:n%15*25+", "+25*parseInt(n/15)+", "+25*(n%15+1)+", "+25*(parseInt(n/15)+1),title:e.expressionMap[105+n]},on:{click:function(t){return e.selectExpression(105+n)}}})})),0)]),i("div",{staticClass:"tool",attrs:{slot:"reference",title:"表情"},slot:"reference"},[i("img",{staticClass:"icon",attrs:{src:n("4c31"),alt:""}})])]),i("div",{staticClass:"tool",attrs:{title:"发送文件"}},[e._m(0),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"toolsFile",attrs:{type:"file",id:"sendFiles",accept:".txt, .doc, .xls, .ppt, .docx, .xlsx, .pptx, .rar, .zip, .exe, .text, .apk, .mp3, .jpg, .png, .gif, .jpeg, .mp4"},on:{change:function(t){return e.choseMedia("File")}}})]),i("div",{staticClass:"tool",attrs:{title:"截图"},on:{click:function(t){return e.shearScreen()}}},[i("img",{staticClass:"icon",attrs:{src:n("d9e1"),alt:""}})]),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"发语音"}},[e._m(1),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"toolsVoice",attrs:{type:"file",id:"sendVoiceId",accept:".amr, .mp3"},on:{change:function(t){return e.choseMedia("Voice")}}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"发名片"},on:{click:e.showSendNameCard}},[i("img",{staticClass:"icon",attrs:{src:n("63c1"),alt:""}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"发红包"},on:{click:e.showRedEnvelopeDialog}},[i("img",{staticClass:"icon",attrs:{src:n("57ad"),alt:""}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"二维码"},on:{click:e.showQrCode}},[i("img",{staticClass:"icon",attrs:{src:n("0591"),alt:""}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"清空聊天资料"},on:{click:e.clearFriendChats}},[i("img",{staticClass:"icon",attrs:{src:n("8f9d"),alt:""}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"发小程序"},on:{click:e.showWeAppDialog}},[i("img",{staticClass:"icon",attrs:{src:n("dde4"),alt:""}})]):e._e(),e.hasCurrentFriend?i("div",{staticClass:"tool",attrs:{title:"发链接"},on:{click:e.showLinkDialog}},[i("img",{staticClass:"icon",attrs:{src:n("0b17"),alt:""}})]):e._e(),e.currentFriend.FriendId?i("div",{staticClass:"tool",attrs:{title:"转账"},on:{click:e.showTransferMoneyDialog}},[i("img",{staticClass:"icon",attrs:{src:n("d029"),alt:""}})]):e._e(),e.currentFriend.UserName?i("div",{staticClass:"tool",attrs:{title:"群二维码"},on:{click:e.showChatRoomQrCode}},[i("img",{staticClass:"icon",attrs:{src:n("3d39"),alt:""}})]):e._e(),e.currentWeChatId?i("div",{staticClass:"tool",attrs:{title:"获取公众号"},on:{click:e.showGH}},[i("img",{staticClass:"icon",attrs:{src:n("22f8"),alt:""}})]):e._e()],1),i("div",{staticClass:"tool-end"},[i("div",{staticClass:"tool",attrs:{title:"历史消息"},on:{click:function(t){return e.showMsgHistory()}}},[i("img",{staticClass:"icon",attrs:{src:n("54d2"),alt:""}})]),i("div",{staticClass:"tool",attrs:{title:"创建群"},on:{click:function(t){return e.createChatRoom()}}},[i("img",{staticClass:"icon",attrs:{src:n("a9a0"),alt:""}})]),i("div",{staticClass:"tool",attrs:{title:e.currentFriend.UserName?"群管理":"好友管理"},on:{click:function(t){e.managerVisiable=!e.managerVisiable}}},[i("img",{staticClass:"icon",attrs:{src:n("2e12"),alt:""}})]),i("div",{staticClass:"tool",attrs:{title:"朋友圈"},on:{click:function(t){return e.showFriendCircle()}}},[i("img",{staticClass:"icon",attrs:{src:n("affb"),alt:""}})])]),e.friendsDialogVisible?i("SlotFriends",{attrs:{dialogTilte:e.dialogTilte,action:e.action,dialogData:e.dialogData,currentFriend:e.currentFriend,friends:e.dialogData,friendsDialogVisible:e.friendsDialogVisible},on:{closeSlotFriends:function(t){e.friendsDialogVisible=!1}}}):e._e(),i("el-dialog",{staticClass:"qr-code-dialog",attrs:{title:e.dialogTilte,visible:e.qrCodeDialog},on:{"update:visible":function(t){e.qrCodeDialog=t}}},[i("el-image",{staticClass:"qr-code-img",attrs:{src:e.qrCode["QrCodeUrl"],fit:"scale-down"}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"100px"}})])]),i("el-row",{staticClass:"created-time",staticStyle:{},attrs:{type:"flex",justify:"center",align:"middle"}},[e.qrCode.ModifyTime?i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.qrCode["ModifyTime"]))}}):e._e(),i("el-button",{staticStyle:{padding:"5px","margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.pullWeChatQrCodeTask}},[e._v("刷新")])],1)],1),i("el-dialog",{staticClass:"qr-code-dialog",attrs:{title:e.dialogTilte,visible:e.chatRoomQrCodeDialog},on:{"update:visible":function(t){e.chatRoomQrCodeDialog=t}}},[i("el-image",{staticClass:"qr-code-img",attrs:{src:e.chatRoomQrCode["QrCodeUrl"],fit:"scale-down"}},[i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"100px"}})])]),i("el-row",{staticClass:"created-time",staticStyle:{},attrs:{type:"flex",justify:"center",align:"middle"}},[e.chatRoomQrCode.ModifyTime?i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.chatRoomQrCode["ModifyTime"]))}}):e._e(),i("el-button",{staticStyle:{padding:"5px","margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.pullChatRoomQrCodeTask}},[e._v("刷新")])],1)],1),i("el-dialog",{staticClass:"red-envelope",attrs:{title:e.dialogTilte,visible:e.redEnvelopeDialog,"before-close":e.resetRedForm},on:{"update:visible":function(t){e.redEnvelopeDialog=t}}},[i("el-form",{ref:"redEnvelope",attrs:{model:e.redForm,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"单个金额",prop:"money"}},[i("el-input",{attrs:{clearable:""},model:{value:e.redForm.money,callback:function(t){e.$set(e.redForm,"money",t)},expression:"redForm.money"}})],1),e.currentFriend.UserName?i("el-form-item",{attrs:{label:"红包个数",prop:"number"}},[i("el-input",{attrs:{clearable:""},model:{value:e.redForm.number,callback:function(t){e.$set(e.redForm,"number",t)},expression:"redForm.number"}})],1):e._e(),i("el-form-item",{attrs:{label:"祝福语",prop:"blessings"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"50",placeholder:"请输入内容"},model:{value:e.redForm.blessings,callback:function(t){e.$set(e.redForm,"blessings",t)},expression:"redForm.blessings"}})],1),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"password",autocomplete:"off","show-password":""},model:{value:e.redForm.password,callback:function(t){e.$set(e.redForm,"password",t)},expression:"redForm.password"}})],1),i("el-form-item",[i("span",{staticClass:"show-money"},[e._v("￥"+e._s(e.redForm.money)+"分")])]),i("el-form-item",[i("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.sendLuckyMoneyTask()}}},[e._v("塞钱进红包")])],1)],1)],1),i("el-dialog",{staticClass:"red-envelope",attrs:{title:e.dialogTilte,visible:e.transferMoneyDialog,"before-close":e.resetRemittanceForm},on:{"update:visible":function(t){e.transferMoneyDialog=t}}},[i("el-form",{ref:"transferMoney",attrs:{model:e.remittanceForm,rules:e.rules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"转账金额",prop:"money"}},[i("el-input",{attrs:{clearable:""},model:{value:e.remittanceForm.money,callback:function(t){e.$set(e.remittanceForm,"money",t)},expression:"remittanceForm.money"}})],1),i("el-form-item",{attrs:{label:"转账说明",prop:"memo"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"50",placeholder:"请输入内容"},model:{value:e.remittanceForm.memo,callback:function(t){e.$set(e.remittanceForm,"memo",t)},expression:"remittanceForm.memo"}})],1),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"password",autocomplete:"off","show-password":""},model:{value:e.remittanceForm.password,callback:function(t){e.$set(e.remittanceForm,"password",t)},expression:"remittanceForm.password"}})],1),i("el-form-item",[i("span",{staticClass:"show-money"},[e._v("￥"+e._s(e.remittanceForm.money)+"分")])]),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.remittanceTask()}}},[e._v("转账")])],1)],1)],1),i("el-dialog",{staticClass:"we-app",attrs:{title:e.dialogTilte,visible:e.wechatAppDialog},on:{"update:visible":function(t){e.wechatAppDialog=t}}},[i("el-form",{ref:"weappDialog",attrs:{model:e.weapp,rules:e.weappRules,"label-width":"110px"}},[e._l(e.weapp,(function(t,n){return i("el-form-item",{key:"weapp"+n,attrs:{label:n,prop:n}},[i("el-input",{attrs:{clearable:""},model:{value:e.weapp[n],callback:function(t){e.$set(e.weapp,n,t)},expression:"weapp[index]"}})],1)})),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.sendWeApp("weappDialog")}}},[e._v("发送")]),i("el-button",{attrs:{type:"info",size:"medium"},on:{click:function(t){return e.resetForm("weappDialog")}}},[e._v("重置")]),i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.choseWeApp}},[e._v(" 从库中选 "),i("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],2)],1),i("el-dialog",{staticClass:"we-app",attrs:{title:e.dialogTilte,visible:e.linkDialog},on:{"update:visible":function(t){e.linkDialog=t}}},[i("el-form",{ref:"linkDialog",attrs:{model:e.linkForm,rules:e.linkRules,"label-width":"110px"}},[e._l(e.linkForm,(function(t,n){return i("el-form-item",{key:"link"+n,attrs:{label:n,prop:n}},[i("el-input",{attrs:{disabled:"TypeStr"===n,clearable:""},model:{value:e.linkForm[n],callback:function(t){e.$set(e.linkForm,n,t)},expression:"linkForm[index]"}})],1)})),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.sendLink("linkDialog")}}},[e._v("发送")]),i("el-button",{attrs:{type:"info",size:"medium"},on:{click:function(t){return e.resetForm("linkDialog")}}},[e._v("重置")]),i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.choseWeApp}},[e._v(" 从库中选 "),i("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],2)],1),i("el-dialog",{staticClass:"gh-dialog",attrs:{title:e.dialogTilte,visible:e.ghDialog},on:{"update:visible":function(t){e.ghDialog=t}}},[i("el-table",{attrs:{data:e.ghList,height:"100%"}},[i("el-table-column",{attrs:{label:"Icon",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("el-avatar",{attrs:{shape:"square",size:80,fit:"cover",src:e.row.Icon}})]}}])}),i("el-table-column",{attrs:{prop:"Alias",label:"Alias",width:"120",align:"center"}}),i("el-table-column",{attrs:{prop:"Nickname",label:"Nickname"}}),i("el-table-column",{attrs:{prop:"Username",label:"Username"}}),i("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"medium",icon:"el-icon-position"},nativeOn:{click:function(n){return n.preventDefault(),e.seeGH(t.row)}}},[e._v("查看消息")])]}}])})],1)],1),i("el-drawer",{staticClass:"manager-drawer",attrs:{modal:!1,"append-to-body":!0,title:e.currentFriend.UserName?"群管理":"设置备注和标签","custom-class":"manager-drawer",visible:e.managerVisiable},on:{"update:visible":function(t){e.managerVisiable=t}}},[e.currentFriend.UserName?i("chat-room-manager",{attrs:{currentFriend:e.currentFriend}}):i("label-remark",{attrs:{currentFriend:e.currentFriend}})],1),i("el-drawer",{staticClass:"circle-drawer",attrs:{title:"我是标题","destroy-on-close":"",direction:"ttb",visible:e.circleDrawerVisiable,"with-header":!1},on:{"update:visible":function(t){e.circleDrawerVisiable=t}}},[i("friend-circle",{attrs:{currentFriend:e.currentFriend}})],1)],1)},d=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{staticClass:"label",attrs:{for:"sendFiles"}},[i("img",{staticClass:"icon",attrs:{src:n("9723"),alt:""}})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("label",{staticClass:"label",attrs:{for:"sendVoiceId"}},[i("img",{staticClass:"icon",attrs:{src:n("10e5"),alt:""}})])}],u=(n("a623"),n("c975"),n("fb6a"),n("b0c0"),n("a9e3"),n("8ba4"),n("ac1f"),n("f6d6"),n("5319"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"slot-friends"},[n("el-dialog",{staticClass:"friends-dialog",attrs:{modal:!1,title:e.dialogTilte,visible:e.friendsDialogVisible,"before-close":e.closeFriendsDialog}},[n("div",{staticClass:"friends-list"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData[e.currentPage-1],stripe:"",border:"",height:"60"}},[n("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),n("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),n("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),n("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),n("el-table-column",{attrs:{label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.formatLabelId(t.row.LabelIds),(function(t,i){return n("el-tag",{key:i,staticClass:"label",domProps:{textContent:e._s(e.$options.filters.labelFilter(t,e.labels))}})}))}}])}),n("el-table-column",{attrs:{width:"180px"},scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:e.friends.length===e.friendIdChose.length?"success":"info"},on:{click:e.choseAllFriends}},[e._v("全选")]),n("el-button",{attrs:{size:"mini",type:e.allCheckState2?"success":"info"},on:{click:e.choseAllOfPage}},[e._v("选本页")]),e._e()]}},{key:"default",fn:function(t){return[2===e.action?n("div",[e.allReadyMember.indexOf(t.row.FriendId)>=0?n("span",{staticClass:"can-not-select"},[e._v("已经是群成员")]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]):3===e.action||10===e.action?n("div",[t.row.FriendId===e.currentFriend.Owner?n("span",{staticClass:"can-not-select"},[e._v("群主")]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]}}])})],1),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[50,100,150,200],"page-size":e.pageSize,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.totalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),n("div",{staticClass:"operation-box"},[n("el-input",{staticClass:"search-input",attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"请输入内容",maxlength:"20","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),n("div",{staticClass:"send-labels"},[0===e.labels.length?n("span",{domProps:{textContent:e._s("没有标签或者刷新通讯录")}}):n("div",{staticClass:"labels scroll"},e._l(e.labels,(function(t,i){return n("el-tag",{key:i,staticClass:"label",domProps:{textContent:e._s(t.LabelName)},on:{click:function(n){return e.showLabel(t)}}})})),1)]),n("el-button",{staticClass:"opration-btn",attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.dialogTilte))])],1)]),n("el-dialog",{staticClass:"filter-dialog",attrs:{title:"标签好友",modal:!1,visible:e.dialogSearchVisible,"before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.searchContent,stripe:"",border:"",height:"60"}},[n("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"60px"}}),n("el-table-column",{attrs:{label:"昵称",prop:"FriendNick"}}),n("el-table-column",{attrs:{label:"头像",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.row.Avatar}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline",staticStyle:{"font-size":"50px"}})])])]}}])}),n("el-table-column",{attrs:{label:"备注名",prop:"Memo"}}),n("el-table-column",{attrs:{label:"标签"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.formatLabelId(t.row.LabelIds),(function(t,i){return n("el-tag",{key:i,staticClass:"label",domProps:{textContent:e._s(e.$options.filters.labelFilter(t,e.labels))}})}))}}])}),n("el-table-column",{scopedSlots:e._u([{key:"header",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:e.allCheckState?"success":"info"},on:{click:e.choseAllSearchContent}},[e._v("全选")]),e._e()]}},{key:"default",fn:function(t){return[2===e.action?n("div",[e.allReadyMember.indexOf(t.row.FriendId)>=0?n("span",{staticClass:"can-not-select"},[e._v("已经是群成员")]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]):3===e.action||10===e.action?n("div",[t.row.FriendId===e.currentFriend.Owner?n("span",{staticClass:"can-not-select"},[e._v("群主")]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]):n("input",{attrs:{type:"checkbox"},domProps:{checked:e.friendIdChose.indexOf(t.row.FriendId)>=0},on:{click:function(n){return e.choseFriend(t.row)}}})]}}])})],1)],1)],1)}),h=[],f=(n("99af"),n("a15b"),n("a434"),n("d3b7"),n("25f0"),n("841c"),n("1276"),n("b85c")),m={data:function(){return{currentPage:1,pageSize:50,friendIdChose:[],tags:[],search:"",searchContent:[],dialogSearchVisible:!1,loading:!1}},props:{currentFriend:{type:Object,required:!0,default:function(){return{}}},friendsDialogVisible:{type:Boolean,required:!0,default:!1},dialogTilte:{type:String,required:!0,default:"好友列表"},action:{type:[String,Number],required:!1,default:0},friends:{type:Array,default:function(){return[]}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({labels:"nedb/labels",currentWeChatId:"conversation/currentWeChatId"})),{},{totalPage:function(){return this.friends.length},tableData:function(){for(var e=[],t=this.pageSize,n=0;n<this.friends.length;n+=t)e.push(this.friends.slice(n,n+t));return e},allCheckState:function(){var e=this,t=this.searchContent.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}));return t},allCheckState2:function(){var e=this,t=this.tableData[this.currentPage-1];return!!t&&t.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}))},allReadyMember:function(){var e=[];return 2===this.action&&(this.currentFriend.MemberList&&(e=[].concat(this.currentFriend.MemberList)),this.currentFriend.WeChatId===this.currentFriend.Owner&&e.push(this.currentFriend.WeChatId)),e}}),methods:{formatLabelId:function(e){var t=[];return e&&(t=e.split(",")),t},closeFriendsDialog:function(){this.$emit("closeSlotFriends",!0)},handleSizeChange:function(e){this.pageSize=e},handleCurrentChange:function(e){this.currentPage=e},indexMethod:function(e){return e+1},searchChange:function(){var e=[],t=this.search;if(t){var n,i=Object(f["a"])(this.friends);try{for(i.s();!(n=i.n()).done;){var r=n.value;(r.FriendNick&&r.FriendNick.indexOf(t)>=0||r.Memo&&r.Memo.indexOf(t)>=0)&&e.push(r)}}catch(a){i.e(a)}finally{i.f()}e.length>0?(this.searchContent=e,this.dialogSearchVisible=!0):this.$message.warning("查不到数据！")}},showLabel:function(e){var t,n=e.LabelId.toString(),i=[],r=Object(f["a"])(this.friends);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.LabelIds){var s=a.LabelIds.split(",");s.indexOf(n)>=0&&i.push(a)}}}catch(o){r.e(o)}finally{r.f()}i.length>0?(this.searchContent=i,this.dialogSearchVisible=!0):this.$message.warning("没有数据")},closeDialog:function(e){this.searchContent=[],e()},choseFriend:function(e){var t=e.FriendId,n=this.friendIdChose.indexOf(t);n>=0?this.friendIdChose.splice(n,1):this.friendIdChose.push(t)},choseAllFriends:function(){if(this.friendIdChose.length>=this.friends.length)this.friendIdChose=[];else{var e,t=Object(f["a"])(this.friends);try{for(t.s();!(e=t.n()).done;){var n=e.value;-1===this.friendIdChose.indexOf(n.FriendId)&&this.friendIdChose.push(n.FriendId)}}catch(i){t.e(i)}finally{t.f()}}},choseAllOfPage:function(){var e=this.tableData[this.currentPage-1];if(this.allCheckState2){var t,n=Object(f["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i.FriendId,a=this.friendIdChose.indexOf(r);this.friendIdChose.splice(a,1)}}catch(u){n.e(u)}finally{n.f()}}else{var s,o=Object(f["a"])(e);try{for(o.s();!(s=o.n()).done;){var c=s.value,l=c.FriendId,d=this.friendIdChose.indexOf(l);d<0&&this.friendIdChose.push(l)}}catch(u){o.e(u)}finally{o.f()}}},choseAllSearchContent:function(){if(this.allCheckState){var e,t=Object(f["a"])(this.searchContent);try{for(t.s();!(e=t.n()).done;){var n=e.value,i=n.FriendId,r=this.friendIdChose.indexOf(i);this.friendIdChose.splice(r,1)}}catch(d){t.e(d)}finally{t.f()}}else{var a,s=Object(f["a"])(this.searchContent);try{for(s.s();!(a=s.n()).done;){var o=a.value,c=o.FriendId,l=this.friendIdChose.indexOf(c);l<0&&this.friendIdChose.push(c)}}catch(d){s.e(d)}finally{s.f()}}},submit:function(){if(2===this.action){var e=this.currentFriend.MemberList.length,t=this.friendIdChose.length;if(e+t>=500)return void this.$message.warning("群人数不能超过500人！")}if(3===this.action){var n=this.friendIdChose.indexOf(this.currentFriend.Owner);n>=0&&this.friendIdChose.splice(n,1)}if(8===this.action){var i=this.friendIdChose.indexOf(this.currentFriend.Owner);if(i>=0&&this.friendIdChose.splice(i,1),this.friendIdChose.length>=500)return void this.$message.warning("群聊人数不能超过500人！")}if(10===this.action){if(this.friendIdChose.length>1)return void this.$message.warning("只能选择一个群成员！");if(this.friendIdChose.indexOf(this.currentFriend.Owner)>=0){var r=this.friendIdChose.indexOf(this.currentFriend.Owner);this.friendIdChose.splice(r,1)}}if("NameCard"===this.action&&this.friendIdChose.length>1)this.$message.warning("只能选择一个好友员！");else if(0!==this.friendIdChose.length){var a={WeChatId:this.currentWeChatId};switch(this.action){case 2:case 3:case 8:case 10:a.ChatRoomId=this.currentFriend.UserName,a.Action=this.action,a.Content=this.friendIdChose.join(","),this.$store.dispatch("websocket/ChatRoomActionTask",a);break;case"NameCard":a.FriendId=this.currentFriend.FriendId||this.currentFriend.UserName,a.ContentType=this.action,a.Content=this.friendIdChose.join(","),this.$store.dispatch("websocket/TalkToFriendTask",a);break;default:break}this.$message.info("任务已经下发!"),this.closeFriendsDialog()}else this.$message.warning("请选择至少选择一个群成员或好友！")}},mounted:function(){}},p=m,C=(n("7697"),n("2877")),b=Object(C["a"])(p,u,h,!1,null,"2f7e56e7",null),g=b.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"label-remark"},[n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[e._v("微信号")]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.FriendNo||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[e._v("昵称")]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.FriendNick||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("备注")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.modifyMemo}}),n("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:""},on:{click:e.deleteMemo}})],1)]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.Memo||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("标签")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addNewLabel}}),n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-price-tag",circle:""},on:{click:e.showLabelDialog}})],1)]),n("div",{staticClass:"friend-item-content"},e._l(e.labelIds,(function(t,i){return n("el-tag",{key:i,attrs:{closable:"",type:""},on:{close:function(n){return e.removeLabel(t)}}},[e._v(e._s(e.labelMap[t]||t))])})),1)]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("电话")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addPhone}}),n("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:"",title:"清空号码"},on:{click:e.deleteAllPhone}})],1)]),n("div",{staticClass:"friend-item-content"},e._l(e.phones,(function(t,i){return n("div",{key:i,staticClass:"phone-item"},[n("span",{domProps:{textContent:e._s(t)}}),n("el-button",{staticClass:"delete-one-phone",attrs:{type:"primary",plain:"",icon:"el-icon-close",circle:""},on:{click:function(t){return e.deleteOnePhone(i)}}})],1)})),0)]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("描述")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.modifyDesc}}),n("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",circle:""},on:{click:e.deleteDesc}})],1)]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.Desc||""))])]),n("div",{staticClass:"friend-item"},[e._m(0),n("div",{staticClass:"friend-item-content"},[e.currentFriend.Source?n("div",{domProps:{textContent:e._s(e.$options.filters.getFriendSource(e.currentFriend.Source))}}):e._e()])]),n("el-dialog",{attrs:{title:"添加标签",visible:e.labelDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.labelDialogVisible=t}}},[n("p",{staticClass:"p-class"},[e._v("手机标签")]),e._l(e.labels,(function(t,i){return n("span",{key:"label"+i,staticClass:"label-class",class:{chose:e.currentTag===t.LabelName},on:{click:function(){e.currentTag=t.LabelName,e.tagKey=t.LabelId}}},[e._v(e._s(t.LabelName))])})),n("p",{staticClass:"p-class"},[e._v("公共标签")]),e._l(e.tags,(function(t,i){return n("span",{key:"tag"+i,staticClass:"label-class",class:{chose:e.currentTag===t.name},on:{click:function(n){e.currentTag=t.name}}},[e._v(e._s(t.name))])})),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.labelDialogVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.modifyLabels}},[e._v("确 定")])],1)],2)],1)},v=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("来源")])])}],F=(n("4de4"),n("4d63"),{name:"LabelRemark",data:function(){return{labelDialogVisible:!1,currentTag:"",tagKey:0}},props:{currentFriend:{type:Object,required:!0,default:function(){return{}}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({labels:"nedb/labels",tags:"conversation/publicTags"})),{},{labelIds:function(){var e=[];return this.currentFriend.LabelIds&&(e=this.currentFriend.LabelIds.split(",")),e},labelMap:function(){var e={};if(this.labels.length>0){var t,n=Object(f["a"])(this.labels);try{for(n.s();!(t=n.n()).done;){var i=t.value;e[i.LabelId]=i.LabelName}}catch(r){n.e(r)}finally{n.f()}}return e},phones:function(){if(this.currentFriend.Phone){var e=this.currentFriend.Phone.replace(/，$/,"");return e.split("，")}return[]}}),methods:{modifyMemo:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的备注！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的备注"),"修改备注",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:this.currentFriend.Memo,inputValue:this.currentFriend.Memo,dangerouslyUseHTMLString:!0,inputPattern:/\S{1,50}/,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Memo:n};e.$store.dispatch("websocket/ModifyFriendMemoTask",i)})).catch((function(){e.$message({type:"info",message:"取消输入"})})):this.$message.warning("请先选择一个好友！")},deleteMemo:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Memo?this.$confirm("删除备注?","删除备注",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:1};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有备注，无需删除！"):this.$message.warning("请先选择一个好友！")},modifyDesc:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的描述！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的描述"),"修改描述",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:this.currentFriend.Desc,inputValue:this.currentFriend.Desc,dangerouslyUseHTMLString:!0,inputPattern:/\S{1,200}/,inputErrorMessage:"备注长度1-200，不能含有特殊字符！"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Desc:n};e.$store.dispatch("websocket/ModifyFriendMemoTask",i)})).catch((function(){e.$message({type:"info",message:"取消输入"})})):this.$message.warning("请先选择一个好友！")},deleteDesc:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Desc?this.$confirm("删除描述?","删除描述",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:2};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有描述，无需删除！"):this.$message.warning("请先选择一个好友！")},addPhone:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能修改公众号的电话！"):this.$prompt('修改<b style="color:green;"> '.concat(this.currentFriend.FriendNick," </b>的电话号码"),"修改电话号码",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"两个号码之间用逗号隔开",inputValue:this.currentFriend.Phone,dangerouslyUseHTMLString:!0}).then((function(t){var n=t.value,i=new RegExp(/0\d{2,3}-[1-9]\d{6,7}|1[3-9]\d{9}/),r=n.replace(/,/g,"，").split("，"),a=r.filter((function(e){return i.test(e)}));if(0===a.length)e.$message.warning("电话号码的格式有问题，请重新输入！");else{var s={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,Phone:a.join(",").replace(/,/g,"，")};e.$store.dispatch("websocket/ModifyFriendMemoTask",s)}})).catch((function(t){e.$message({type:"warning",message:t})})):this.$message.warning("请先选择一个好友！")},deleteAllPhone:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.Phone?this.$confirm("清空电话?","清空电话",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,FriendId:e.currentFriend.FriendId,DelFlag:4};e.$store.dispatch("websocket/ModifyFriendMemoTask",t)})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有电话，无需清空！"):this.$message.warning("请先选择一个好友！")},deleteOnePhone:function(e){var t=this;this.currentFriend.FriendId?this.currentFriend.Phone?this.$confirm("删除该电话?","删除该电话",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n,i="",r=Object(f["a"])(t.phones);try{for(r.s();!(n=r.n()).done;){var a=n.value;a!==t.phones[e]&&(i=a+"，")}}catch(c){r.e(c)}finally{r.f()}i=i.replace(/，$/,"");var s={WeChatId:t.currentFriend.WeChatId,FriendId:t.currentFriend.FriendId,Phone:i};if(""!==i)t.$store.dispatch("websocket/ModifyFriendMemoTask",s);else{var o={WeChatId:t.currentFriend.WeChatId,FriendId:t.currentFriend.FriendId,DelFlag:4};t.$store.dispatch("websocket/ModifyFriendMemoTask",o)}})).catch((function(){t.$message({type:"info",message:"已取消删除"})})):this.$message.warning("该好友没有电话，无需清空！"):this.$message.warning("请先选择一个好友！")},addNewLabel:function(){var e=this;this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能给公众号打标签！"):this.$prompt("标签名不能与现有的重复！","新建标签",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,200}/,inputErrorMessage:"标签长度不对"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,LabelName:n,LabelId:0,AddList:e.currentFriend.FriendId};e.$store.dispatch("websocket/ContactLabelTask",i)})).catch((function(){})):this.$message.warning("请先选择一个好友！")},removeLabel:function(e){var t=this;this.currentFriend.FriendId?this.$confirm("移除该标签?","移除标签",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n={WeChatId:t.currentFriend.WeChatId,LabelId:e,DelList:t.currentFriend.FriendId};t.$store.dispatch("websocket/ContactLabelTask",n)})).catch((function(){})):this.$message.warning("请先选择一个好友！")},showLabelDialog:function(){this.currentFriend.FriendId?this.currentFriend.isGh?this.$message.warning("不能给公众号打标签！"):this.labelDialogVisible=!0:this.$message.warning("请先选择一个好友！")},handleClose:function(e){this.currentTag="",this.tagKey=0,e()},modifyLabels:function(){var e=!0;if(0===this.tagKey){var t,n=Object(f["a"])(this.labels);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.LabelName===this.currentTag){this.tagKey=i.LabelId;break}}}catch(c){n.e(c)}finally{n.f()}}if(this.currentTag){var r,a=Object(f["a"])(this.labelIds);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(this.labelMap[s]===this.currentTag){e=!1;break}}}catch(c){a.e(c)}finally{a.f()}if(e){var o={WeChatId:this.currentFriend.WeChatId,AddList:this.currentFriend.FriendId,LabelName:this.currentTag,LabelId:this.tagKey};this.$store.dispatch("websocket/ContactLabelTask",o),this.labelDialogVisible=!1,this.currentTag="",this.tagKey=0}else this.$message.error("该标签已经打过")}else this.$message.warning("请选择一个标签！")}},created:function(){0===this.tags.length&&this.$store.dispatch("websocket/GetCommonTags")}}),y=F,k=(n("af6b"),Object(C["a"])(y,D,v,!1,null,"5245d6c6",null)),I=k.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"label-remark scroll"},[n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("群聊名称")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeRoomName}})],1)]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.NickName||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("群公告")]),n("div",{staticClass:"btns"},[e.currentFriend.WeChatId===e.currentFriend.Owner?n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeNotice}}):e._e()],1)]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.Notice||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("群内昵称")]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit-outline",circle:""},on:{click:e.changeMyRoomName}})],1)]),n("div",{staticClass:"friend-item-content"},[e._v(e._s(e.currentFriend.SelfDisplayName||""))])]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v("群主")]),n("div",{staticClass:"btns"},[e.currentFriend.WeChatId===e.currentFriend.Owner?n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-s-promotion",circle:""},on:{click:e.transferOwner}}):e._e()],1)]),n("div",{staticClass:"friend-item-content owner"},[n("el-avatar",{staticClass:"avatar",staticStyle:{"min-width":"40px"},attrs:{shape:"square",size:40,src:e.friendMap[e.currentFriend.Owner]?e.friendMap[e.currentFriend.Owner].Avatar:e.memberMap[e.currentFriend.Owner]?e.memberMap[e.currentFriend.Owner].Avatar:"",title:e.currentFriend.Owner},on:{error:e.errorHandler},nativeOn:{click:function(t){return e.showMemberDetail(e.currentFriend.Owner)}}},[n("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]),n("div",{staticClass:"owner-name"},[e.friendMap[e.currentFriend.Owner]?n("span",{domProps:{textContent:e._s(e.friendMap[e.currentFriend.Owner].FriendNick)}}):e.memberMap[e.currentFriend.Owner]?n("span",{domProps:{textContent:e._s(e.memberMap[e.currentFriend.Owner].Nickname)}}):n("span",{domProps:{textContent:e._s(e.currentFriend.Owner)}})])],1)]),n("div",{staticClass:"friend-item"},[n("div",{staticClass:"friend-item-title"},[n("span",{staticClass:"tip"},[e._v(" 群成员 "),n("span",{domProps:{textContent:e._s(e.currentFriend.MemberList.length+"个人")}})]),n("div",{staticClass:"btns"},[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",circle:""},on:{click:e.addMember}}),n("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-minus",circle:""},on:{click:e.kickMember}})],1)]),n("div",{staticClass:"friend-item-content avatars"},e._l(e.currentFriend.MemberList,(function(t,i){return n("el-avatar",{directives:[{name:"show",rawName:"v-show",value:i<e.maxNumber,expression:"index < maxNumber"}],key:i,staticClass:"avatar",class:{"not-friend":!e.friendMap[t]},attrs:{shape:"square",size:40,src:e.friendMap[t]&&e.friendMap[t].Avatar?e.friendMap[t].Avatar:e.memberMap[t]&&e.memberMap[t].Avatar?e.memberMap[t].Avatar:"",title:e.friendMap[t]&&e.friendMap[t].FriendNick?e.friendMap[t].FriendNick:e.memberMap[t]&&e.memberMap[t].Nickname?e.memberMap[t].Nickname:t},on:{error:e.errorHandler},nativeOn:{click:function(n){return e.showMemberDetail(t)}}},[n("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})])})),1),n("div",{staticClass:"friend-item-footer"},[n("el-button",{staticClass:"footer-btn",attrs:{size:"medium",type:"primary"},on:{click:e.showAllMember}},[e._v("查看全部群成员")])],1)]),n("el-button",{staticStyle:{margin:"15px 0"},attrs:{type:"danger"},on:{click:e.deleteAndLogout}},[e._v("删除并退出")]),e.friendsDialogVisible?n("SlotFriends",{attrs:{dialogTilte:e.dialogTilte,action:e.action,dialogData:e.dialogData,currentFriend:e.currentFriend,friends:e.dialogData,friendsDialogVisible:e.friendsDialogVisible},on:{closeSlotFriends:function(t){e.friendsDialogVisible=!1}}}):e._e(),n("el-dialog",{staticClass:"member-detail",attrs:{modal:!1,title:"群成员详情",visible:e.memberDialog},on:{"update:visible":function(t){e.memberDialog=t}}},[n("div",{staticClass:"member-detail-info"},[n("el-avatar",{attrs:{shape:"square",size:100,src:e.memberDetail.Avatar},on:{error:e.errorHandler}},[n("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]),n("div",{staticClass:"member-detail-text"},[n("p",[e._v(" 微信： "),n("span",{domProps:{textContent:e._s(e.memberDetail.FriendId)}})]),n("p",[e._v(" 昵称： "),n("span",{domProps:{textContent:e._s(e.memberDetail.FriendNick||"- -")}})]),n("p",[e._v(" 性别： "),n("span",{domProps:{textContent:e._s(e.memberDetail.Gender||"- -")}})]),n("p",[e._v(" 地址： "),n("span",{domProps:{textContent:e._s(e.memberDetail.Province||"-")}}),e._v(" "),n("span",{domProps:{textContent:e._s(e.memberDetail.City||"-")}})])])],1),n("div",{staticClass:"member-detail-btns"},[e.friendMap[e.memberDetail.FriendId]?e._e():n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.getMemberDetail}},[e._v("获取详情")]),e.friendMap[e.memberDetail.FriendId]?e._e():n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addToAddress}},[e._v("添加到通讯录")])],1)])],1)},T=[],x={name:"ChatRoomManager",data:function(){return{maxNumber:30,memberDialog:!1,memberDetail:{},action:0,dialogTilte:"添加群成员",dialogData:[],friendsDialogVisible:!1,doNotTouch:0,saveToAddress:0,setInvitationConfirm:0}},props:{currentFriend:{type:Object,required:!0,default:function(){return{}}}},components:{SlotFriends:g},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({members:"nedb/members",friends:"nedb/friendsAll"})),{},{memberMap:function(){var e,t={},n=Object(f["a"])(this.members);try{for(n.s();!(e=n.n()).done;){var i=e.value;t[i.Wxid]=i}}catch(r){n.e(r)}finally{n.f()}return t},friendMap:function(){var e,t={},n=Object(f["a"])(this.friends);try{for(n.s();!(e=n.n()).done;){var i=e.value;t[i.FriendId]=i}}catch(r){n.e(r)}finally{n.f()}return t}}),methods:{errorHandler:function(){return!0},changeRoomName:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改群聊名称","修改群聊名称",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,50}/,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:0,Content:n};e.$store.dispatch("websocket/ChatRoomActionTask",i)})).catch((function(){e.$message.info("取消输入")})):this.$message.warning("请先选择一个群！")},changeMyRoomName:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改我的群昵称","修改我的群昵称",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,50}/,inputErrorMessage:"备注长度1-50，不能含有特殊字符！"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:4,Content:n};e.$store.dispatch("websocket/ChatRoomActionTask",i)})).catch((function(){e.$message.info("取消输入")})):this.$message.warning("请先选择一个群！")},changeNotice:function(){var e=this;this.currentFriend.UserName?this.$prompt("修改群公告","修改群公告",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"备注长度1-500，不能含有特殊字符！"}).then((function(t){var n=t.value,i={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:1,Content:n};e.$store.dispatch("websocket/ChatRoomActionTask",i)})).catch((function(){e.$message.info("取消输入")})):this.$message.warning("请先选择一个群！")},deleteAndLogout:function(){var e=this;this.currentFriend.UserName?this.$confirm("删除并退出群?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={WeChatId:e.currentFriend.WeChatId,ChatRoomId:e.currentFriend.UserName,Action:7};e.$store.dispatch("websocket/ChatRoomActionTask",t),e.$message.success("指令已经下发！")})).catch((function(){e.$message.info("已取消删除")})):this.$message.warning("请先选择一个群！")},addMember:function(){this.dialogTilte="拉人进群",this.action=2,this.friendsDialogVisible=!0,this.dialogData=this.friends},kickMember:function(){if(this.currentFriend.WeChatId===this.currentFriend.Owner){var e,t=[],n=Object(f["a"])(this.currentFriend.MemberList);try{for(n.s();!(e=n.n()).done;){var i=e.value,r="";this.friendMap[i]&&this.friendMap[i].Avatar?r=this.friendMap[i].Avatar:this.memberMap[i]&&this.memberMap[i].Avatar&&(r=this.memberMap[i].Avatar);var a="";this.friendMap[i]&&this.friendMap[i].FriendNick?a=this.friendMap[i].FriendNick:this.memberMap[i]&&this.memberMap[i].Nickname&&(a=this.memberMap[i].Nickname);var s={WeChatId:this.currentFriend.WeChatId,FriendId:i,Avatar:r,FriendNick:a,LabelIds:this.friendMap[i]&&this.friendMap[i].LabelIds?this.friendMap[i].LabelIds:""};t.push(s)}}catch(o){n.e(o)}finally{n.f()}this.dialogData=t,this.dialogTilte="踢人出群",this.action=3,this.friendsDialogVisible=!0}else this.$message.warning("你不是群主！")},transferOwner:function(){if(this.currentFriend.WeChatId===this.currentFriend.Owner){var e,t=[],n=Object(f["a"])(this.currentFriend.MemberList);try{for(n.s();!(e=n.n()).done;){var i=e.value,r="";this.friendMap[i]&&this.friendMap[i].Avatar?r=this.friendMap[i].Avatar:this.memberMap[i]&&this.memberMap[i].Avatar&&(r=this.memberMap[i].Avatar);var a="";this.friendMap[i]&&this.friendMap[i].FriendNick?a=this.friendMap[i].FriendNick:this.memberMap[i]&&this.memberMap[i].Nickname&&(a=this.memberMap[i].Nickname);var s={WeChatId:this.currentFriend.WeChatId,FriendId:i,Avatar:r,FriendNick:a,LabelIds:this.friendMap[i]&&this.friendMap[i].LabelIds?this.friendMap[i].LabelIds:""};t.push(s)}}catch(o){n.e(o)}finally{n.f()}this.dialogData=t,this.dialogTilte="群主转让",this.action=10,this.friendsDialogVisible=!0}else this.$message.warning("你不是群主！")},showAllMember:function(){30===this.maxNumber&&this.viewAllMember(),30===this.maxNumber?this.maxNumber=500:this.maxNumber=30},viewAllMember:function(){var e={WeChatId:this.currentFriend.WeChatId,ChatRoomId:this.currentFriend.UserName,Action:9};this.$store.dispatch("websocket/ChatRoomActionTask",e),this.$message.info("指令已经下发！")},showMemberDetail:function(e){this.friendMap[e]?this.memberDetail=this.friendMap[e]:this.memberMap[e]?this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:e,Avatar:this.memberMap[e].Avatar?this.memberMap[e].Avatar:"",FriendNick:this.memberMap[e].Nickname?this.memberMap[e].Nickname:"",LabelIds:""}:this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:e,Avatar:"",FriendNick:"",LabelIds:""},this.memberDialog=!0},addToAddress:function(){var e={WeChatId:this.memberDetail.WeChatId,ChatroomId:this.currentFriend.UserName,FriendId:this.memberDetail.FriendId,Message:"",Remark:""};this.$store.dispatch("websocket/AddFriendInChatRoomTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")},getMemberDetail:function(){var e={wechatId:this.memberDetail.WeChatId,friendId:this.memberDetail.FriendId};this.$store.dispatch("websocket/RequestContactsInfoTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")}},created:function(){this.viewAllMember=this._.throttle(this.viewAllMember,5e3)}},_=x,M=(n("de5b"),Object(C["a"])(_,w,T,!1,null,"49274291",null)),$=M.exports,E=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticClass:"friend-circle scroll"},[e.circleCount>0?[e._l(e.count,(function(t,r){return i("li",{key:r,class:{"circle-itme":e.currentCircles[t-1]}},[e.currentCircles[t-1]?[e.currentCircles[t-1].Content.Text?i("div",{staticClass:"circle-div circle-text",domProps:{textContent:e._s(e.currentCircles[t-1].Content.Text)}}):e._e(),e.currentCircles[t-1].Content.Link?i("div",{staticClass:"circle-div circle-link",attrs:{title:"点击打开链接"},on:{click:function(n){return e.openLink(e.currentCircles[t-1])}}},[e.currentCircles[t-1].Content.Images?i("img",{attrs:{src:e.currentCircles[t-1].Content.Images[0].ThumbImg,alt:"这是link"}}):i("span",{staticClass:"circle-link-description",domProps:{textContent:e._s("无效链接")}}),i("span",{staticClass:"circle-link-description",domProps:{textContent:e._s(e.currentCircles[t-1].Content.Link.Description)}})]):e.currentCircles[t-1].Content.Images?i("div",{staticClass:"circle-div circle-img"},e._l(e.currentCircles[t-1].Content.Images,(function(n,r){return i("div",{key:r,staticClass:"img-div"},[n.ThumbImg?i("img",{attrs:{src:n.ThumbImg,alt:"图片地址错误"}}):i("img",{attrs:{src:n.ThumbImg,alt:"点击获取缩略图"},on:{click:function(n){return e.pullCircleDetailTask(e.currentCircles[t-1])}}})])})),0):e.currentCircles[t-1].Content.Video?i("div",{staticClass:"circle-div circle-video"},[i("video",{staticClass:"video",attrs:{controls:""}},[i("source",{attrs:{src:e.currentCircles[t-1].Content.Video.Url,type:"video/mp4"}})])]):e._e(),i("div",{staticClass:"circle-div time-operation"},[i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(e.currentCircles[t-1].PublishTime))}}),i("div",[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-star-off"},on:{click:function(n){return e.likeCircle(e.currentCircles[t-1])}}},[e._v("点赞")]),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(n){return e.circleCommentReplyTask(e.currentCircles[t-1])}}},[e._v("评论")]),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:function(n){return e.triggerCirclePushTask(e.currentCircles[t-1])}}},[e._v("刷新")])],1)]),e.currentCircles[t-1].Likes?i("div",{staticClass:"circle-div likes-box"},[i("i",{staticClass:"fa fa-heart-o",attrs:{"aria-hidden":"true"}}),i("div",e._l(e.currentCircles[t-1].Likes,(function(t,r){return i("div",{key:r},[i("img",{attrs:{src:e.currentfriendsMap[t.FriendId]?e.currentfriendsMap[t.FriendId].Avatar:n("f067")}})])})),0)]):e._e(),e.currentCircles[t-1].Comments?i("div",{staticClass:"circle-div comment-box"},e._l(e.currentCircles[t-1].Comments,(function(r,a){return i("div",{key:a,staticClass:"every-comment"},[i("img",{attrs:{src:e.currentfriendsMap[r.FromWeChatId]?e.currentfriendsMap[r.FromWeChatId].Avatar:n("f067")}}),i("div",{staticClass:"comment-info"},[i("div",{staticClass:"name-time"},[i("span",{staticClass:"ellipsis",domProps:{textContent:e._s(e.currentfriendsMap[r.FromWeChatId]?e.currentfriendsMap[r.FromWeChatId].FriendNick:r.FromWeChatId)}}),i("span",{domProps:{textContent:e._s(e.$options.filters.timeFilter(r.PublishTime))}})]),i("div",{staticClass:"reply-1"},[i("div",{staticClass:"reply-to-friend",attrs:{title:r.Content}},[r.ToWeChatId?i("span",[e._v(" 回复 "),i("span",{staticClass:"reply-friend-name",domProps:{textContent:e._s(e.currentfriendsMap[r.ToWeChatId]?e.currentfriendsMap[r.ToWeChatId].FriendNick:r.ToWeChatId)}}),e._v(" : ")]):e._e(),i("span",{staticClass:"comment-content",domProps:{textContent:e._s(r.Content)}})]),r.FromWeChatId===e.currentFriend.WeChatId?i("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true",title:"删除"},on:{click:function(n){return e.circleCommentDeleteTask(e.currentCircles[t-1],r)}}}):i("i",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true",title:"回复"},on:{click:function(n){return e.circleCommentReplyTask(e.currentCircles[t-1],r)}}})])])])})),0):e._e()]:e._e()],2)})),e.loading?i("li",{staticClass:"li-loading"},[i("i",{staticClass:"el-icon-loading"}),e._v("加载中... ")]):e._e(),e.noMore?i("li",{staticClass:"li-btn"},[i("el-button",{staticStyle:{margin:"10px"},attrs:{loading:e.pullFriendCircle,disabled:e.pullFriendCircle,size:"small",type:"primary"},on:{click:e.getMore}},[e._v("获取更多")])],1):e._e()]:i("li",{staticClass:"get-btn"},[i("el-button",{attrs:{loading:e.pullFriendCircle,disabled:e.pullFriendCircle,type:"primary"},on:{click:e.getMore}},[e._v("获取朋友圈")])],1)],2)},S=[],N={name:"FriendCircle",data:function(){return{loading:!1,count:5,pullFriendCircle:!1}},props:{currentFriend:{type:Object,required:!0,default:function(){return{}}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({friendsMap:"nedb/friendsMap",currentCircles:"nedb/conversationCircles"})),{},{currentfriendsMap:function(){var e=this.currentFriend.WeChatId;return e&&this.friendsMap[e]?this.friendsMap[e]:{}},circleCount:function(){return this.currentCircles.length},noMore:function(){return this.count>=this.circleCount}}),methods:{load:function(){var e=this;this.count<this.circleCount&&!this.loading?(this.loading=!0,setTimeout((function(){e.loading=!1,e.count++}),1e3)):this.count===this.circleCount&&this.$message.info("点击按钮获取更多")},getMore:function(){var e=this;this.pullFriendCircle=!0;var t=this.currentCircles.length,n=t>0?this.currentCircles[t-1].PublishTime:0,i={wechatId:this.currentFriend.WeChatId,friendId:this.currentFriend.FriendId,startTime:Number(n),count:5};this.$store.dispatch("websocket/PullFriendCircleTask",i),setTimeout((function(){e.pullFriendCircle=!1}),8e3)},openLink:function(e){var t=e.Content.Link.Url,n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("target","_blank"),n.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(n),n.click()},likeCircle:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t["WeChatId"]=this.currentFriend.WeChatId,t["FriendId"]=e.WeChatId,this.$store.dispatch("websocket/CircleLikeTask",t),this.$message.info("点赞任务已发出！")},triggerCirclePushTask:function(e){this.$message.info("任务已经下发!");var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t["WeChatId"]=this.currentFriend.WeChatId,t["FriendId"]=e.WeChatId,this.$store.dispatch("websocket/TriggerCirclePushTask",t)},circleCommentReplyTask:function(e,t){var n=this,i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i["WeChatId"]=this.currentFriend.WeChatId,i["FriendId"]=e.WeChatId,t&&(i.currentComment=t),this.$prompt("请输入评论内容","评论",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S{1,500}/,inputErrorMessage:"评论字数1-500"}).then((function(e){var t=e.value;n.$message.info("任务已经下发！"),i.value=t,n.$store.dispatch("websocket/CircleCommentReplyTask",i)})).catch((function(){n.$message.info("取消任务！")}))},circleCommentDeleteTask:function(e,t){var n=this,i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i["WeChatId"]=this.currentFriend.WeChatId,i["FriendId"]=e.WeChatId,t&&(i.currentComment=t),this.$confirm("确认删除该评论 ?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.$store.dispatch("websocket/CircleCommentDeleteTask",i),n.$message.info("已提交任务")})).catch((function(){n.$message.info("已取消删除")}))},pullCircleDetailTask:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t["WeChatId"]=this.currentFriend.WeChatId,t["FriendId"]=e.WeChatId,this.$store.dispatch("websocket/PullCircleDetailTask",t),this.$message.info("任务已经下发!")}},created:function(){this.$store.dispatch("nedb/SetConversationCircles",this.currentFriend)}},O=N,A=(n("68a9"),Object(C["a"])(O,E,S,!1,null,"66a2cfd4",null)),W=A.exports,R={data:function(){var e=this,t=function(t,n,i){if(!n)return i(new Error("金额不能为空"));n=Number(n),Number.isInteger(n)?n<0?i(new Error("必须大于0")):n>2e4?i(new Error("必须小于20000")):parseInt(n/e.redForm.number)<1?i(new Error("单个红包金额不可低于0.01元！")):i():i(new Error("请输入数字值"))},n=function(t,n,i){if(!n)return i(new Error("数量不能为空"));n=Number(n),Number.isInteger(n)?n<0?i(new Error("必须大于0")):n>2e4?i(new Error("必须小于100")):parseInt(e.redForm.money/n)<1?i(new Error("单个红包金额不可低于0.01元！")):i():i(new Error("请输入数字值"))};return{qrCodeDialog:!1,chatRoomQrCodeDialog:!1,redEnvelopeDialog:!1,transferMoneyDialog:!1,managerVisiable:!1,circleDrawerVisiable:!1,wechatAppDialog:!1,linkDialog:!1,ghDialog:!1,weappRules:{AppId:[{required:!0,message:"请输入AppId",trigger:"blur"}],SourceName:[{required:!0,message:"请输入SourceName",trigger:"blur"}],Icon:[{required:!0,message:"请输入Icon",trigger:"blur"}],PagePath:[{required:!0,message:"请输入PagePath",trigger:"blur"}],Title:[{required:!0,message:"请输入Title",trigger:"blur"}],Thumb:[{required:!0,message:"请输入Thumb",trigger:"blur"}]},weapp:{AppId:"wxe99ba6e7fa3e8672",SourceName:"gh_5b0c2f762fc0@app",Icon:"http://wx.qlogo.cn/mmhead/Q3auHgzwzM5bBMPvk6Oohdlo4FpjGgLsTtcSYJKhibnoQWFphTVy7Bw/96",Source:"建业+",Title:"考拉之选 点断保鲜膜 食品级材质",Thumb:"http://gaia-projectc.oss-cn-hangzhou.aliyuncs.com/wxid_9988ti1oz81g22%2Fth_2fb4cbd7008c2e3cc33f6e49573c00cc.jpg",PagePath:"pages/index/index.html?_type=h5Link&h5url=https%3A%2F%2Fmall.yijiahn.com%2Fmall%2Fapp%2Fstatic%2Fgoods%2F3711147.html%3Fid%3D3711147&sharedUserId=2269485"},linkForm:{Des:"腾讯新闻 事实派",Source:"",Thumb:"http://www.jjldkj.com/files/phone/files/20200929/C738E93E7CB008A55AB617B789160854.jpg",Title:"习近平提“4个坚持”推动中欧关系发展",TypeStr:"[链接]",Url:"https://view.inews.qq.com/k/20200915A0B8I100?fontRatio=1&openid=o04IBAPM5TvGFVAsbK7x9E3IdNQs&key=1ece873f79715ee8c3bce80ed2f0658ba6c0c1a25f034bca383f06daa3112d64c459e34ad1604de9d78db129ef73b75a2806ae16083a061ab796c5a1c2c1d36a5c0e152aca68a0943b800ada20a391fecf664ea6029280f1c1515b638063d16be25efbdd5ea0549a77db58e04587d7365816f058a5850ee29c61ddad7ef621ef&version=27001135&devicetype=android-29&wuid=oDdoCt1c2dvaUXS-phjN2zofQmOw&cv=0x27001135&dt=2&lang=zh_CN&pass_ticket=TWLEm7NEJBgdbN0Jm7Ljpmn7lrIDtBRSiXxwDfXXQcqSmDjKlEJi6CukY3wFLoR%2F&sharer=o04IBAPM5TvGFVAsbK7x9E3IdNQs&uid=&shareto="},linkRules:{Title:[{required:!0,message:"请输入Title",trigger:"blur"}],Thumb:[{required:!0,message:"请输入Thumb",trigger:"blur"}],Url:[{required:!0,message:"请输入Url",trigger:"blur"}],Des:[{required:!0,message:"请输入Des",trigger:"blur"}]},action:0,dialogTilte:"添加群成员",dialogData:[],friendsDialogVisible:!1,redForm:{money:1,number:1,blessings:"恭喜发财，大吉大利",password:""},rules:{money:[{required:!0,message:"请输入红包金额1-20000分",trigger:"blur"},{validator:t,trigger:"blur"}],number:[{required:!0,message:"请输入红包个数",trigger:"blur"},{validator:n,trigger:"blur"}],blessings:[{required:!0,message:"请输入祝福语",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:6,message:"密码长度不对",trigger:"blur"}]},remittanceForm:{money:1,password:"",memo:""},expressionMap:{0:"微笑",1:"撇嘴",2:"色",3:"发呆",4:"得意",5:"流泪",6:"害羞",7:"闭嘴",8:"睡",9:"大哭",10:"尴尬",11:"发怒",12:"调皮",13:"呲牙",14:"惊讶",15:"难过",16:"酷",17:"冷汗",18:"抓狂",19:"吐",20:"偷笑",21:"愉快",22:"白眼",23:"傲慢",24:"饥饿",25:"困",26:"惊恐",27:"流汗",28:"憨笑",29:"悠闲",30:"奋斗",31:"咒骂",32:"疑问",33:"嘘",34:"晕",35:"疯了",36:"衰",37:"骷髅",38:"敲打",39:"再见",40:"擦汗",41:"抠鼻",42:"鼓掌",43:"糗大了",44:"坏笑",45:"左哼哼",46:"右哼哼",47:"哈欠",48:"鄙视",49:"委屈",50:"快哭了",51:"阴险",52:"亲亲",53:"吓",54:"可怜",55:"菜刀",56:"西瓜",57:"啤酒",58:"篮球",59:"乒乓",60:"咖啡",61:"饭",62:"猪头",63:"玫瑰",64:"凋谢",65:"嘴唇",66:"爱心",67:"心碎",68:"蛋糕",69:"闪电",70:"炸弹",71:"刀",72:"足球",73:"瓢虫",74:"便便",75:"月亮",76:"太阳",77:"礼物",78:"拥抱",79:"强",80:"弱",81:"握手",82:"胜利",83:"抱拳",84:"勾引",85:"拳头",86:"差劲",87:"爱你",88:"NO",89:"OK",90:"爱情",91:"飞吻",92:"跳跳",93:"发抖",94:"怄火",95:"转圈",96:"磕头",97:"回头",98:"跳绳",99:"投降",100:"激动",101:"乱舞",102:"献吻",103:"左太极",104:"右太极",105:"笑脸",106:"生病",107:"破涕为笑",108:"吐舌",109:"脸红",110:"恐惧",111:"失望",112:"无语",113:"嘿哈",114:"捂脸",115:"奸笑",116:"机智",117:"皱眉",118:"耶",119:"鬼魂",120:"合十",121:"强壮",122:"庆祝",123:"礼物",124:"红包",125:"鸡",126:"开心",127:"大笑",128:"热情",129:"眨眼",130:"色",131:"接吻",132:"亲吻",133:"露齿笑",134:"满意",135:"戏弄",136:"得意",137:"汗",138:"低落",139:"呸",140:"焦虑",141:"担心",142:"震惊",143:"悔恨",144:"眼泪",145:"哭",146:"晕",147:"心烦",148:"生气",149:"睡觉",150:"恶魔",151:"外星人",152:"心",153:"心碎",154:"丘比特",155:"闪烁",156:"星星",157:"叹号",158:"问号",159:"睡着",160:"水滴",161:"音乐",162:"火",163:"便便",164:"强",165:"弱",166:"拳头",167:"胜利",168:"上",169:"下",170:"右",171:"左",172:"第一",173:"吻",174:"热恋",175:"男孩",176:"女孩",177:"女士",178:"男士",179:"天使",180:"骷髅",181:"红唇",182:"太阳",183:"下雨",184:"多云",185:"雪人",186:"月亮",187:"闪电",188:"海浪",189:"猫",190:"小狗",191:"老鼠",192:"仓鼠",193:"兔子",194:"狗",195:"青蛙",196:"老虎",197:"考拉",198:"熊",199:"猪",200:"牛",201:"野猪",202:"猴子",203:"马",204:"蛇",205:"鸽子",206:"鸡",207:"企鹅",208:"毛虫",209:"章鱼",210:"鱼",211:"鲸鱼",212:"海豚",213:"玫瑰",214:"花",215:"棕榈树",216:"仙人掌",217:"礼盒",218:"南瓜灯",219:"圣诞老人",220:"圣诞树",221:"铃",222:"气球",223:"CD",224:"相机",225:"录像机",226:"电脑",227:"电视",228:"电话",229:"解锁",230:"锁",231:"钥匙",232:"成交",233:"灯泡",234:"邮箱",235:"浴缸",236:"钱",237:"炸弹",238:"手枪",239:"药丸",240:"橄榄球",241:"篮球",242:"足球",243:"棒球",244:"高尔夫",245:"奖杯",246:"入侵者",247:"唱歌",248:"吉他",249:"比基尼",250:"皇冠",251:"雨伞",252:"手提包",253:"口红",254:"戒指",255:"钻石",256:"咖啡",257:"啤酒",258:"干杯",259:"鸡尾酒",260:"汉堡",261:"薯条",262:"意面",263:"寿司",264:"面条",265:"煎蛋",266:"冰激凌",267:"蛋糕",268:"苹果",269:"飞机",270:"火箭",271:"自行车",272:"高铁",273:"警告",274:"旗",275:"男人",276:"女人",277:"O",278:"X",279:"版权",280:"注册商标",281:"商标"},emojiMap:{"<笑脸>":"1f604","<笑臉>":"1f604","<Laugh>":"1f604","<开心>":"1f60a","<開心>":"1f60a","<Happy>":"1f60a","<大笑>":"1f603","<Big Smile>":"1f603","<热情>":"263a","<熱情>":"263a","<Glowing>":"263a","<眨眼>":"1f609","<Wink>":"1f609","<色>":"1f60d","<Love>":"1f60d","<Drool>":"1f60d","<接吻>":"1f618","<Smooch>":"1f618","<亲吻>":"1f61a","<親吻>":"1f61a","<Kiss>":"1f61a","<脸红>":"1f633","<臉紅>":"1f633","<Blush>":"1f633","<露齿笑>":"1F601","<露齒笑>":"1F601","<Grin>":"1f63c","<满意>":"1f60c","<滿意>":"1f60c","<Satisfied>":"1f60c","<戏弄>":"1f61c","<戲弄>":"1f61c","<Tease>":"1f61c","<吐舌>":"1F61D","<Tongue>":"1F61D","<无语>":"1f612","<無語>":"1f612","<Speechless>":"1f612","<得意>":"1f60f","<Smirk>":"1f60f","<CoolGuy>":"1f60f","<汗>":"1f613","<Sweat>":"1f613","<失望>":"1F614","<Let Down>":"1F614","<合十>":"1f64f","<祈禱>":"1f64f","<低落>":"1f61e","<Low>":"1f61e","<呸>":"1f616","<Ugh>":"1f616","<焦虑>":"1f625","<焦慮>":"1f625","<Anxious>":"1f625","<担心>":"1f630","<擔心>":"1f630","<Worried>":"1f630","<震惊>":"1f628","<震驚>":"1f628","<Shocked>":"1f628","<悔恨>":"1f62b","<D’oh!>":"1f62b","<眼泪>":"1f622","<眼淚>":"1f622","<Tear>":"1f622","<哭>":"1f62d","<Cry>":"1f62d","<破涕为笑>":"1f602","<破涕為笑>":"1f602","<Lol>":"1f602","<晕>":"1F632","<Dead>":"1f632","<Dizzy>":"1f632","<恐惧>":"1f631","<恐懼>":"1f631","<Terror>":"1f631","<心烦>":"1f620","<心煩>":"1f620","<Upset>":"1f620","<生气>":"1F621","<生氣>":"1F621","<Angry>":"1F621","<睡觉>":"1f62a","<睡覺>":"1f62a","<Zzz>":"1f62a","<生病>":"1f637","<Sick>":"1f637","<恶魔>":"1f47f","<惡魔>":"1f47f","<Demon>":"1f47f","<外星人>":"1f47d","<Alien>":"1f47d","<心>":"2764","<Heart>":"2764","<心碎>":"1f494","<Heartbroken>":"1f494","<BrokenHeart>":"1f494","<丘比特>":"1f498","<Cupid>":"1f498","<闪烁>":"2728","<閃爍>":"2728","<Twinkle>":"2728","<星星>":"1f31f","<Star>":"1f31f","<叹号>":"2755","<嘆號>":"2755","<!>":"2755","<问号>":"2754","<問號>":"2754","<?>":"2754","<睡着>":"1f4a4","<睡著>":"1f4a4","<Asleep>":"1f4a4","<水滴>":"1f4a6","<Drops>":"1f4a6","<音乐>":"1f3b5","<音樂>":"1f3b5","<Music>":"1f3b5","<火>":"1f525","<Fire>":"1f525","<便便>":"1f4a9","<Poop>":"1f4a9","<强>":"1f44d","<強>":"1f44d","<ThumbsUp>":"1f44d","<弱>":"1f44e","<ThumbsDown>":"1f44e","<拳头>":"1f44a","<拳頭>":"1f44a","<Punch>":"1f44a","<Fist>":"1f44a","<胜利>":"270c","<勝利>":"270c","<Peace>":"270c","<上>":"1f446","<Up>":"1f446","<下>":"1f447","<Down>":"1f447","<右>":"1f449","<Right>":"1f449","<左>":"1f448","<Left>":"1f448","<第一>":"261d","<#1>":"261d","<强壮>":"1f4aa","<強壯>":"1f4aa","<Strong>":"1f4aa","<吻>":"1f48f","<Kissing>":"1f48f","<热恋>":"1f491","<熱戀>":"1f491","<Couple>":"1f491","<男孩>":"1f466","<Boy>":"1f466","<女孩>":"1f467","<Girl>":"1f467","<女士>":"1f469","<Lady>":"1f469","<男士>":"1f468","<Man>":"1f468","<天使>":"1f47c","<Angel>":"1f47c","<骷髅>":"1f480","<骷髏頭>":"1f480","<骷髏>":"1f480","<Skull>":"1f480","<红唇>":"1f48b","<紅唇>":"1f48b","<Lips>":"1f48b","<太阳>":"2600","<太陽>":"2600","<Sun>":"2600","<下雨>":"2614","<Rain>":"2614","<多云>":"2601","<多雲>":"2601","<Cloud>":"2601","<雪人>":"26c4","<Snowman>":"26c4","<月亮>":"1f319","<Moon>":"1f319","<闪电>":"26a1","<閃電>":"26a1","<Lightning>":"26a1","<海浪>":"1f30a","<Waves>":"1f30a","<猫>":"1f431","<貓>":"1f431","<Cat>":"1f431","<小狗>":"1F436","<Doggy>":"1F436","<老鼠>":"1f42d","<Mouse>":"1f42d","<仓鼠>":"1f439","<倉鼠>":"1f439","<Hamster>":"1f439","<兔子>":"1f430","<Rabbit>":"1f430","<狗>":"1f43a","<Dog>":"1f43a","<青蛙>":"1f438","<Frog>":"1f438","<老虎>":"1f42f","<Tiger>":"1f42f","<考拉>":"1f428","<Koala>":"1f428","<熊>":"1f43b","<Bear>":"1f43b","<猪>":"1f437","<豬>":"1f437","<Pig>":"1f437","<牛>":"1f42e","<Cow>":"1f42e","<野猪>":"1f417","<野豬>":"1f417","<Boar>":"1f417","<猴子>":"1f435","<Monkey>":"1f435","<马>":"1f434","<馬>":"1f434","<Horse>":"1f434","<蛇>":"1f40d","<Snake>":"1f40d","<鸽子>":"1f426","<鴿子>":"1f426","<Pigeon>":"1f426","<鸡>":"1f414","<雞>":"1f414","<Chicken>":"1f414","<企鹅>":"1f427","<企鵝>":"1f427","<Penguin>":"1f427","<毛虫>":"1f41b","<毛蟲>":"1f41b","<Caterpillar>":"1f41b","<章鱼>":"1f419","<八爪魚>":"1f419","<Octopus>":"1f419","<鱼>":"1f420","<魚>":"1f420","<Fish>":"1f420","<鲸鱼>":"1f433","<鯨魚>":"1f433","<Whale>":"1f433","<海豚>":"1f42c","<Dolphin>":"1f42c","<玫瑰>":"1f339","<Rose>":"1f339","<花>":"1f33a","<Flower>":"1f33a","<棕榈树>":"1f334","<棕櫚樹>":"1f334","<Palm>":"1f334","<仙人掌>":"1f335","<Cactus>":"1f335","<礼盒>":"1f49d","<禮盒>":"1f49d","<Candy Box>":"1f49d","<南瓜灯>":"1f383","<南瓜燈>":"1f383","<Jack-o-lantern>":"1f383","<鬼魂>":"1f47b","<Ghost>":"1f47b","<圣诞老人>":"1f385","<聖誕老人>":"1f385","<Santa>":"1f385","<圣诞树>":"1f384","<聖誕樹>":"1f384","<Xmas Tree>":"1f384","<礼物>":"1f381","<禮物>":"1f381","<Gift>":"1f381","<铃>":"1f514","<鈴鐺>":"1f514","<Bell>":"1f514","<庆祝>":"1f389","<慶祝>":"1f389","<Party>":"1f389","<气球>":"1f388","<氣球>":"1f388","<Balloon>":"1f388","<CD>":"1f4bf","<相机>":"1f4f7","<相機>":"1f4f7","<Camera>":"1f4f7","<录像机>":"1f3a5","<錄影機>":"1f3a5","<Film Camera>":"1f3a5","<电脑>":"1f4bb","<電腦>":"1f4bb","<Computer>":"1f4bb","<电视>":"1f4fa","<電視>":"1f4fa","<TV>":"1f4fa","<电话>":"1f4de","<電話>":"1f4de","<Phone>":"1f4de","<解锁>":"1f513","<解鎖>":"1f513","<Unlocked>":"1f513","<锁>":"1f512","<鎖>":"1f512","<Locked>":"1f512","<钥匙>":"1f511","<鑰匙>":"1f511","<Key>":"1f511","<成交>":"1f528","<Judgement>":"1f528","<灯泡>":"1f4a1","<燈泡>":"1f4a1","<Light bulb>":"1f4a1","<邮箱>":"1f4eb","<郵箱>":"1f4eb","<Mail>":"1f4eb","<浴缸>":"1f6c0","<Wash>":"1f6c0","<钱>":"1f4b2","<錢>":"1f4b2","<Money>":"1f4b2","<炸弹>":"1f4a3","<炸彈>":"1f4a3","<Bomb>":"1f4a3","<手枪>":"1f52b","<手槍>":"1f52b","<Pistol>":"1f52b","<药丸>":"1f48a","<藥丸>":"1f48a","<Pill>":"1f48a","<橄榄球>":"1f3c8","<橄欖球>":"1f3c8","<Football>":"1f3c8","<篮球>":"1f3c0","<籃球>":"1f3c0","<Basketball>":"1f3c0","<足球>":"26bd","<Soccer Ball>":"26bd","<Soccer>":"26bd","<棒球>":"26be","<Baseball>":"26be","<高尔夫>":"26f3","<高爾夫>":"26f3","<Golf>":"26f3","<奖杯>":"1f3c6","<獎盃>":"1f3c6","<Trophy>":"1f3c6","<入侵者>":"1f47e","<Invader>":"1f47e","<唱歌>":"1f3a4","<Singing>":"1f3a4","<吉他>":"1f3b8","<Guitar>":"1f3b8","<比基尼>":"1f459","<Bikini>":"1f459","<皇冠>":"1f451","<Crown>":"1f451","<雨伞>":"1f302","<雨傘>":"1f302","<Umbrella>":"1f302","<手提包>":"1f45c","<Purse>":"1f45c","<口红>":"1f484","<口紅>":"1f484","<Lipstick>":"1f484","<戒指>":"1f48d","<Ring>":"1f48d","<钻石>":"1f48e","<鑽石>":"1f48e","<Gem>":"1f48e","<咖啡>":"2615","<Coffee>":"2615","<啤酒>":"1f37a","<Beer>":"1f37a","<干杯>":"1f37b","<乾杯>":"1f37b","<Toast>":"1f37b","<鸡尾酒>":"1F378","<雞尾酒>":"1F378","<Martini>":"1F378","<汉堡>":"1f354","<漢堡>":"1f354","<Burger>":"1f354","<薯条>":"1f35f","<薯條>":"1f35f","<Fries>":"1f35f","<意面>":"1f35d","<意粉>":"1f35d","<Sphaghetti>":"1f35d","<寿司>":"1f363","<壽司>":"1f363","<Sushi>":"1f363","<面条>":"1f35c","<麵條>":"1f35c","<Noodles>":"1f35c","<煎蛋>":"1f373","<Eggs>":"1f373","<冰激凌>":"1f366","<雪糕>":"1f366","<Ice Cream>":"1f366","<蛋糕>":"1f382","<Cake>":"1f382","<苹果>":"1F34E","<蘋果>":"1F34E","<Apple>":"1F34E","<飞机>":"2708","<飛機>":"2708","<Plane>":"2708","<火箭>":"1f680","<Rocket ship>":"1f680","<自行车>":"1f6b2","<單車>":"1f6b2","<Bike>":"1f6b2","<高铁>":"1f684","<高鐵>":"1f684","<Bullet Train>":"1f684","<警告>":"26a0","<Warning>":"26a0","<旗>":"1f3c1","<Flag>":"1f3c1","<男人>":"1f6b9","<男>":"1f6b9","<Men>":"1f6b9","<女人>":"1f6ba","<女>":"1f6ba","<Women>":"1f6ba","<O>":"2b55","<X>":"274C","<版权>":"a9","<版權>":"a9","<Copyright>":"a9","<注册商标>":"ae","<注冊商標>":"ae","<Registered TM>":"ae","<商标>":"2122","<商標>":"2122","<Trademark>":"2122"}}},components:{SlotFriends:g,FriendCircle:W,LabelRemark:I,ChatRoomManager:$},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({ghMap:"conversation/ghMap",content:"conversation/content",contentType:"conversation/contentType",currentFriends:"conversation/currentFriends",currentWeChatId:"conversation/currentWeChatId",friends:"nedb/friendsAll",labels:"nedb/labels",qrCode:"nedb/conversationQrCode",chatRoomQrCode:"nedb/chatRoomQrCode"})),{},{ghList:function(){return this.ghMap[this.currentWeChatId]?this.ghMap[this.currentWeChatId]:[]},currentFriend:function(){return this.currentFriends[this.currentWeChatId]||{}},totalPage:function(){return this.friends.length},tableData:function(){for(var e=[],t=this.pageSize,n=0;n<this.friends.length;n+=t)e.push(this.friends.slice(n,n+t));return e},allCheckState:function(){var e=this,t=this.searchContent.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}));return t},allCheckState2:function(){var e=this,t=this.tableData[this.currentPage-1];return!!t&&t.every((function(t){return e.friendIdChose.indexOf(t.FriendId)>=0}))},hasCurrentFriend:function(){return"{}"!==JSON.stringify(this.currentFriend)},currentQrCode:function(){return!!this.qrcodes[this.currentWechats.WeChatId]&&this.qrcodes[this.currentWechats.WeChatId]},currentChatRoomQrCode:function(){return!!this.chatRoomQrCodes[this.currentFriend.UserName]&&this.chatRoomQrCodes[this.currentFriend.UserName]}}),methods:{selectExpression:function(e){"Text"!==this.contentType&&this.$store.commit("conversation/SET_CONTENT","");var t=this.expressionMap[e],n=[113,114,115,116,117,118,124,125];if(t){if(e<105||n.indexOf(e)>=0)t="["+this.expressionMap[e]+"]";else{t="<"+t+">",t=this.emojiMap[t];var i=parseInt(t,16);t=String.fromCodePoint(i)}var r=this.content+t;this.$store.commit("conversation/SET_CONTENT_TYPE","Text"),this.$store.commit("conversation/SET_CONTENT",r)}},choseMedia:function(e){var t=this,n=new FormData,i="",r="";if(i="Voice"===e?this.$refs.toolsVoice.files:this.$refs.toolsFile.files,i[0]){var a=i[0].size,s=i[0].name,o=i[0].name.replace(/.+\./,"").toLowerCase();if(a>104857600||a<=0)return void this.$message.warning("文件不能大于100M，文件不能是空文件");if("Voice"===e){if(r="Voice",["amr","mp3"].indexOf(o)<0)return void this.$message.warning("发送语音只能选择MP3或AMR文件")}else r="mp4"===o?"Video":["jpg","png","gif","jpeg"].indexOf(o)>=0?"Picture":"File";n.append("myfile",i[0]);var c=this.$loading({lock:!0,text:"文件上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});if("Voice"===e){"mp3"===o?n.append("isMp3ToAmr",!0):"amr"===o&&n.append("isAmrToMp3",!1);var l=new FormData;l.append("myfile",i[0]),"mp3"===o?l.append("isMp3ToAmr",!1):"amr"===o&&l.append("isAmrToMp3",!0),this.$store.dispatch("UploadFile",l).then((function(e){})).catch((function(e){}))}this.$store.dispatch("UploadFile",n).then((function(n){var i=n.url;"File"===r&&(i=JSON.stringify({name:s,url:n.url,size:a,Source:"pc"})),t.$store.commit("conversation/SET_CONTENT",i),t.$store.commit("conversation/SET_CONTENT_TYPE",r),c.close(),"Voice"===e?t.$refs.toolsVoice.value="":t.$refs.toolsFile.value=""})).catch((function(e){t.$message({message:"文件上传失败："+e,type:"error",duration:0,showClose:!0}),c.close()}))}},showQrCode:function(){var e=this;this.currentWeChatId?(this.qrCode.WeChatId!==this.currentWeChatId&&this.$store.dispatch("nedb/SetConversationQrCode",this.currentWeChatId),this.dialogTilte="微信二维码",setTimeout((function(){e.qrCodeDialog=!0}),100)):this.$message.warning("请选选中微信！")},showChatRoomQrCode:function(){var e=this;this.currentWeChatId?(this.chatRoomQrCode.ChatRoomId&&this.chatRoomQrCode.ChatRoomId===this.currentFriend.UserName||this.$store.dispatch("nedb/SetChatRoomQrCode",this.currentFriend),this.dialogTilte="群聊二维码",setTimeout((function(){e.chatRoomQrCodeDialog=!0}),100)):this.$message.warning("请选选中微信！")},pullWeChatQrCodeTask:function(){this.$store.dispatch("websocket/PullWeChatQrCodeTask",this.currentWeChatId),this.$message.info("正在获取，请稍等")},pullChatRoomQrCodeTask:function(){this.$store.dispatch("websocket/PullChatRoomQrCodeTask",this.currentFriend),this.$message.info("正在获取，请稍等")},showMsgHistory:function(){this.$message.info("待完成，敬请期待！")},createChatRoom:function(){this.currentWeChatId?(this.dialogTilte="创建群聊",this.action=8,this.dialogData=this.friends,this.friendsDialogVisible=!0):this.$message.warning("请先选择一个微信！")},showSendNameCard:function(){this.dialogTilte="发送名片",this.action="NameCard",this.dialogData=this.friends,this.friendsDialogVisible=!0},shearScreen:function(){"electron"===Object({NODE_ENV:"production",BASE_URL:""}).VUE_APP_CURRENTMODE?"electron"===Object({NODE_ENV:"production",BASE_URL:""}).VUE_APP_CURRENTMODE&&this.$ipcRenderer.send("operations","screencap"):this.$message.warning("web版不支持截图！")},clearFriendChats:function(){var e=this;this.$confirm("此操作将删除本都的聊天数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$store.dispatch("nedb/RemoveChatsByWxId",e.currentFriend),e.$message({type:"success",message:"删除成功!"})})).catch((function(){e.$message.info("已取消删除")}))},showRedEnvelopeDialog:function(){this.redEnvelopeDialog=!0,this.dialogTilte="发红包"},sendLuckyMoneyTask:function(){var e=this;this.currentWeChatId?this.$refs["redEnvelope"].validate((function(t){if(!t)return!1;e.$confirm("即将发送红包?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.currentFriend.WeChatId,n=e.currentFriend.FriendId||e.currentFriend.UserName,i={WeChatId:t,FriendId:n,Money:e.redForm.money,Number:1,Passwd:e.redForm.password,Wish:e.redForm.blessings};e.$store.dispatch("websocket/SendLuckyMoneyTask",i),e.$message.success("任务已经下发！"),e.redEnvelopeDialog=!1,e.$refs["redEnvelope"].resetFields()})).catch((function(){}))})):this.$message.warning("请选选中微信！")},resetRedForm:function(e){this.$refs["redEnvelope"].resetFields(),e()},showTransferMoneyDialog:function(){this.transferMoneyDialog=!0,this.dialogTilte="转账"},resetRemittanceForm:function(e){this.$refs["transferMoney"].resetFields(),e()},remittanceTask:function(){var e=this;this.currentWeChatId?this.$refs["transferMoney"].validate((function(t){if(!t)return!1;e.$confirm("确认转账?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.currentFriend.WeChatId,n=e.currentFriend.FriendId,i={WeChatId:t,FriendId:n,Money:e.remittanceForm.money,Passwd:e.remittanceForm.password,Memo:e.remittanceForm.memo};e.$store.dispatch("websocket/RemittanceTask",i),e.$message.success("任务已经下发！"),e.transferMoneyDialog=!1,e.$refs["transferMoney"].resetFields()})).catch((function(){e.$message.info("取消转账!")}))})):this.$message.warning("请选选中微信！")},showFriendCircle:function(){"{}"!==JSON.stringify(this.currentFriend)?this.currentFriend.FriendId?this.circleDrawerVisiable=!0:this.$message.warning("群没有朋友圈!"):this.$message.warning("请先选择好友!")},showWeAppDialog:function(){this.wechatAppDialog=!0,this.dialogTilte="发小程序"},showLinkDialog:function(){this.linkDialog=!0,this.dialogTilte="发链接"},sendWeApp:function(e){var t=this;this.$refs[e].validate((function(n){if(!n)return!1;var i=(new Date).getTime(),r={WeChatId:t.currentWeChatId,FriendId:t.currentFriend.FriendId||t.currentFriend.UserName,ContentType:"WeApp",Content:JSON.stringify(t.weapp),Remark:"",MsgId:1e4*i+parseInt(1e4*Math.random())};t.$store.dispatch("websocket/TalkToFriendTask",r),t.$message.success("任务已经下发！"),t.wechatAppDialog=!1,t.$refs[e].resetFields()}))},sendLink:function(e){var t=this;this.$refs[e].validate((function(n){if(!n)return!1;var i=(new Date).getTime(),r={WeChatId:t.currentWeChatId,FriendId:t.currentFriend.FriendId||t.currentFriend.UserName,ContentType:"Link",Content:JSON.stringify(t.linkForm),Remark:"",MsgId:1e4*i+parseInt(1e4*Math.random())};t.$store.dispatch("websocket/TalkToFriendTask",r),t.$message.success("任务已经下发！"),t.wechatAppDialog=!1,t.$refs[e].resetFields()}))},choseWeApp:function(){this.$message("待实现，敬请期待！")},resetForm:function(e){this.$refs[e].resetFields()},showGH:function(){this.$store.dispatch("websocket/TriggerBizContactPushTask"),this.ghDialog=!0,this.dialogTilte="公众号列表"},seeGH:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);e.Avatar||(t.Avatar=e.Icon),t.WeChatId=this.currentWeChatId,t.NickName=e.Nickname,t.FriendId=e.Username,t.isGh=!0;var i={wechatId:this.currentWeChatId,friend:t};this.$store.commit("conversation/SET_CURRENT_FRIENDS",i),this.ghDialog=!1},getHistory:function(){},getBizContact:function(){},autoHit:function(){}},mounted:function(){var e=this;document.body.onpaste=function(t){var n=t.clipboardData||window.clipboardData,i=n.items;if(i&&i.length){var r=i[0].getAsFile();if(r){var a=new FormData;a.append("myfile",r,"image.png"),e.$store.dispatch("UploadFile",a).then((function(t){var n=t.url;e.$store.commit("conversation/SET_CONTENT",n),e.$store.commit("conversation/SET_CONTENT_TYPE","Picture")})).catch((function(e){}))}}}}},P=R,L=(n("eb69"),Object(C["a"])(P,l,d,!1,null,"5d586b67",null)),j=L.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"anwser-window"},[n("div",{staticClass:"scroll show-content"},["Text"===e.contentType?n("textarea",{ref:"anwserText",staticClass:"scroll show-content-textarea",attrs:{id:"textarea",maxlength:"1000",autofocus:""},domProps:{value:e.content},on:{input:e.setContent,keydown:function(t){return t.type.indexOf("key")||13===t.keyCode?t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.enterSend(t):null},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:e.lineFeed(t):null}}}):"Picture"===e.contentType?n("img",{staticClass:"show-content-img",attrs:{src:e.content,alt:"图片丢失"}}):"Video"===e.contentType?n("video",{staticClass:"show-content-video",attrs:{src:e.content,controls:""}}):e._e(),"Voice"===e.contentType&&/.mp3$/.test(e.content)?n("audio",{staticClass:"show-content-voice",attrs:{src:e.content,type:"audio/mp3",controls:""}}):e._e(),"Voice"!==e.contentType||/.mp3$/.test(e.content)?"File"===e.contentType?n("span",{staticClass:"show-content-file",domProps:{textContent:e._s(e.$options.filters.getFileName(e.content))}}):e._e():n("span",{staticClass:"show-content-file",domProps:{textContent:e._s(e.content)}})]),n("div",{staticClass:"opration-btn"},[n("el-button",{attrs:{icon:"el-icon-mic",type:"plant",size:"small"},nativeOn:{mousedown:function(t){return e.handlerDown(t)},mouseup:function(t){return e.handlerUp(t)}}},[e._v("按住说话")]),n("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.clearContent}},[e._v("清空")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.talkToFriendTask}},[e._v("发送(Enter)")])],1)])},U=[],V={data:function(){return{}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({remark:"conversation/remark",content:"conversation/content",contentType:"conversation/contentType",currentFriends:"conversation/currentFriends",currentWechat:"conversation/currentWechat",currentWeChatId:"conversation/currentWeChatId"})),{},{currentFriend:function(){return this.currentWeChatId&&this.currentFriends[this.currentWeChatId]?this.currentFriends[this.currentWeChatId]:{}}}),methods:{talkToFriendTask:function(){if(this.currentWeChatId)if(this.currentWechat.IsOnline&&this.currentWechat.IsLogined)if("{}"!==JSON.stringify(this.currentFriend)){var e=this.content.replace(/\s/gi,"");if(e){var t={WeChatId:this.currentWeChatId,FriendId:this.currentFriend.FriendId||this.currentFriend.UserName,ContentType:this.contentType,Content:this.content,Remark:this.remark};this.currentFriend.UserName?this.currentFriend.MemberList&&this.currentFriend.MemberList.indexOf(this.currentWeChatId)>=0?(this.$store.dispatch("websocket/TalkToFriendTask",t),this.clearContent()):this.$message.warning("你已被踢出群聊,不能在该群发送消息!"):(this.$store.dispatch("websocket/TalkToFriendTask",t),this.clearContent())}else this.$message.warning("请设置发送内容！")}else this.$message.warning("请先选择一个好友！");else this.$message.warning("".concat(this.currentWechat.WeChatNick," 不在线或者未登陆，不能给其发消息！"));else this.$message.warning("请先选中微信！")},lineFeed:function(){var e=this.content+"\r\n";this.$store.commit("conversation/SET_CONTENT",e)},enterSend:function(e){e.preventDefault(),this.talkToFriendTask()},setContent:function(e){var t=this.$refs.anwserText.value;this.$store.commit("conversation/SET_CONTENT",t)},clearContent:function(){this.$store.commit("conversation/SET_CONTENT",""),this.$store.commit("conversation/SET_CONTENT_TYPE","Text")},handlerDown:function(){},handlerUp:function(){}},created:function(){this.talkToFriendTask=this._.throttle(this.talkToFriendTask,500)}},z=V,q=(n("b39b"),Object(C["a"])(z,B,U,!1,null,"eda05ff8",null)),H=q.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"show-chats scroll",attrs:{id:"show-chat"},on:{scroll:e.newPage}},[e._l(e.chats,(function(t,i){return n("div",{key:i,staticClass:"chat-item"},[n("div",{staticClass:"chat-time",domProps:{textContent:e._s(e.$options.filters.timeFilter(t.CreateTime))}}),n("div",{staticClass:"chat-content",class:{"chat-content-send":!!t.IsSend}},[-1===e.notShow.indexOf(t.ContentType)?n("el-avatar",{attrs:{shape:"square",size:40,src:e.getAvatar(t),title:"头像"},on:{error:function(){return!0}},nativeOn:{click:function(n){return e.showMemberDetail(t)}}},[n("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]):e._e(),e.currentFriend.UserName&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)?n("div",{staticClass:"member-info"},[n("span",{domProps:{textContent:e._s(e.getMemberName(t.Content))}}),n("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(n){return e.atSomebody(t)}}},[e._v("@Ta")]),e.currentFriend.Owner&&e.currentFriend.Owner===e.currentWeChatId?n("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini",disabled:e.knicking,loading:e.knicking},on:{click:function(n){return e.knickSomeBody(t)}}},[e._v("踢人")]):e._e()],1):e._e(),n("div",{staticClass:"content-content",class:[{"triangle-send":t.IsSend&&-1===e.notShow.indexOf(t.ContentType)},{triangle:-1===e.notShow.indexOf(t.ContentType)&&!t.IsSend},{"chat-room":e.currentFriend.UserName&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)},{"system-info":e.notShow.indexOf(t.ContentType)>-1}]},[n("div",{class:[{"chat-picture":"Picture"===t.ContentType||2===t.ContentType},{"chat-voice":"Voice"===t.ContentType||3===t.ContentType},{"chat-video":"Video"===t.ContentType||4===t.ContentType},{"chat-link":"Link"===t.ContentType||6===t.ContentType},{"chat-file":"File"===t.ContentType||8===t.ContentType},{"chat-namecard":"NameCard"===t.ContentType||9===t.ContentType},{"chat-luckmoney":"LuckyMoney"===t.ContentType||11===t.ContentType},{"chat-moneytran":"MoneyTrans"===t.ContentType||12===t.ContentType},{"chat-app":"WeApp"===t.ContentType||13===t.ContentType},{"chat-system":e.notShow.indexOf(t.ContentType)>-1}],domProps:{innerHTML:e._s(e.decodeChat(t))},on:{click:function(n){return e.whatToDo(t)}}})]),n("div",{staticClass:"send-state",class:{"chat-room":e.currentFriend.UserName&&!t.IsSend&&-1===e.notShow.indexOf(t.ContentType)}},[t.IsSend&&!t.msgSvrId?n("el-button",{staticClass:"el-icon-loading",attrs:{type:"text"}}):e._e(),t.revoked?n("el-button",{staticClass:"el-icon-info",staticStyle:{"margin-left":"10px",color:"#e6a23c",padding:"5px"},attrs:{type:"text",title:"已撤回"}},[e._v("已撤回")]):e._e(),t.IsSend&&t.msgSvrId&&!t.revoked&&e.revokeMap.indexOf(t.ContentType)>=0&&t.canRevoke?n("el-button",{staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini",loading:e.revoking,disabled:e.revoking},on:{click:function(n){return e.revokeMessageTask(t)}}},[e._v("撤回")]):e._e(),t.msgSvrId&&e.revokeMap.indexOf(t.ContentType)>=0?n("el-button",{staticClass:"el-icon-s-promotion",staticStyle:{"margin-left":"10px",color:"#909399",padding:"5px"},attrs:{type:"plant",size:"mini"},on:{click:function(n){return e.canTransform(t)}}},[e._v("转发")]):e._e()],1)],1)])})),0===e.chats.length?n("div",{staticClass:"chat-no"}):e._e(),n("el-dialog",{staticClass:"detail-dialog",attrs:{title:"详情",visible:e.detailDialogVisible,width:"30%","before-close":e.handleDeatilClose},on:{"update:visible":function(t){e.detailDialogVisible=t}}},[e.detailUrl&&(e.detailUrl.endsWith(".png")||e.detailUrl.endsWith(".jpg")||e.detailUrl.endsWith(".gif"))?n("el-image",{staticClass:"detail-dialog-img",attrs:{src:e.detailUrl}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])]):e.detailUrl&&e.detailUrl.endsWith(".mp4")?n("video",{staticClass:"detail-dialog-video",attrs:{src:e.detailUrl,controls:""}}):e.detailUrl?n("a",{attrs:{target:"_blank",href:e.detailUrl}},[e._v("点击下载")]):n("span",[n("i",{staticClass:"el-icon-loading"}),e._v(" 正在获取详情 ")])],1),n("el-dialog",{staticClass:"member-detail",attrs:{title:"群成员详情",visible:e.memberDialog},on:{"update:visible":function(t){e.memberDialog=t}}},[n("div",{staticClass:"member-detail-info"},[n("el-avatar",{attrs:{shape:"square",size:100,src:e.memberDetail.Avatar},on:{error:e.errorHandler}},[n("img",{attrs:{src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]),n("div",{staticClass:"member-detail-text"},[n("p",[e._v(" 微信： "),n("span",{domProps:{textContent:e._s(e.memberDetail.FriendId)}})]),n("p",[e._v(" 昵称： "),n("span",{domProps:{textContent:e._s(e.memberDetail.FriendNick||"- -")}})]),n("p",[e._v(" 性别： "),n("span",{domProps:{textContent:e._s(e.memberDetail.Gender||"- -")}})]),n("p",[e._v(" 地址： "),n("span",{domProps:{textContent:e._s(e.memberDetail.Province||"-")}}),e._v(" "),n("span",{domProps:{textContent:e._s(e.memberDetail.City||"-")}})])])],1),n("div",{staticClass:"member-detail-btns"},[e.friendMap[e.memberDetail.FriendId]?e._e():n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.getMemberDetail}},[e._v("获取详情")]),e.friendMap[e.memberDetail.FriendId]?e._e():n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.addToAddress}},[e._v("添加到通讯录")])],1)]),n("el-dialog",{staticClass:"hb-details",attrs:{title:"红包详情",visible:e.hbDetailVisible},on:{"update:visible":function(t){e.hbDetailVisible=t}}},[n("ul",{staticClass:"hb-detail"},[n("li",[e._v("当前微信："+e._s(e.hbDetail.WeChatId))]),n("li",[e._v("红包来源："+e._s(e._f("hbUrlFilter")(e.hbDetail.HbUrl)))]),n("li",[e._v("红包总数："+e._s(e.hbDetail.TotalNum))]),n("li",[e._v("红包总金额："+e._s(e.hbDetail.TotalAmount))]),n("li",[e._v("已抢的数量："+e._s(e.hbDetail.RecNum))]),n("li",[e._v("已抢的金额："+e._s(e.hbDetail.RecAmount))]),n("li",[e._v(" 抢红包的好友列表 "),n("ul",e._l(e.hbDetail.Records,(function(t,i){return n("li",{key:i},[n("div",[e._v(e._s(t))])])})),0)])]),n("div",{staticClass:"hb-btns"},[n("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){e.hbDetailVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.takeLuckMoney(e.hb2detail)}}},[e._v("打开红包")])],1)])],2)},G=[],J=(n("8a79"),n("2ca0"),n("498a"),n("53ca")),K=(n("466d"),{"[微笑]":"0","[撇嘴]":"1","[色]":"2","[发呆]":"3","[得意]":"4","[流泪]":"5","[害羞]":"6","[闭嘴]":"7","[睡]":"8","[大哭]":"9","[尴尬]":"10","[发怒]":"11","[调皮]":"12","[呲牙]":"13","[惊讶]":"14","[难过]":"15","[酷]":"16","[冷汗]":"17","[囧]":"17","[抓狂]":"18","[吐]":"19","[偷笑]":"20","[可爱]":"20","[愉快]":"21","[白眼]":"22","[傲慢]":"23","[饥饿]":"24","[困]":"25","[惊恐]":"26","[流汗]":"27","[憨笑]":"28","[悠闲]":"29","[大兵]":"29","[奋斗]":"30","[咒骂]":"31","[疑问]":"32","[嘘]":"33","[晕]":"34","[疯了]":"35","[折磨]":"35","[衰]":"36","[骷髅]":"37","[敲打]":"38","[再见]":"39","[擦汗]":"40","[抠鼻]":"41","[鼓掌]":"42","[糗大了]":"43","[坏笑]":"44","[左哼哼]":"45","[右哼哼]":"46","[哈欠]":"47","[鄙视]":"48","[委屈]":"49","[快哭了]":"50","[阴险]":"51","[亲亲]":"52","[吓]":"53","[可怜]":"54","[菜刀]":"55","[西瓜]":"56","[啤酒]":"57","[篮球]":"58","[乒乓]":"59","[咖啡]":"60","[饭]":"61","[猪头]":"62","[玫瑰]":"63","[凋谢]":"64","[嘴唇]":"65","[示爱]":"65","[爱心]":"66","[心碎]":"67","[蛋糕]":"68","[闪电]":"69","[炸弹]":"70","[刀]":"71","[足球]":"72","[瓢虫]":"73","[便便]":"74","[月亮]":"75","[太阳]":"76","[礼物]":"77","[拥抱]":"78","[强]":"79","[弱]":"80","[握手]":"81","[胜利]":"82","[抱拳]":"83","[勾引]":"84","[拳头]":"85","[差劲]":"86","[爱你]":"87","[NO]":"88","[OK]":"89","[爱情]":"90","[飞吻]":"91","[跳跳]":"92","[发抖]":"93","[怄火]":"94","[转圈]":"95","[磕头]":"96","[回头]":"97","[跳绳]":"98","[投降]":"99","[激动]":"100","[乱舞]":"101","[献吻]":"102","[左太极]":"103","[右太极]":"104"}),X={"[嘿哈]":"8","[捂脸]":"9","[奸笑]":"10","[机智]":"11","[皱眉]":"12","[耶]":"13","[鸡]":"20","[红包]":"19"},Y={"\\ue415":"0","%uD83D%uDE04":"0","\\ue40C":"1","%uD83D%uDE37":"1","\\ue412":"2","%uD83D%uDE02":"2","\\ue409":"3","%uD83D%uDE1D":"3","\\ue40D":"4","%uD83D%uDE33":"4","\\ue107":"5","%uD83D%uDE31":"5","\\ue403":"6","%uD83D%uDE14":"6","\\ue40E":"7","%uD83D%uDE12":"7","\\ue11B":"14","%uD83D%uDC7B":"14","\\ue41D":"15","\\ue14C":"16","%uD83D%uDCAA":"16","\\ue312":"17","%uD83C%uDF89":"17","\\ue112":"18","%uD83C%uDF81":"18","%uD83D%uDE0A":"21","%uD83D%uDE03":"22","%u263A":"23","%uD83D%uDE09":"24","%uD83D%uDE0D":"25","%uD83D%uDE18":"26","%uD83D%uDE1A":"27","%uD83D%uDE01":"28","%uD83D%uDE0C":"29","%uD83D%uDE1C":"30","%uD83D%uDE0F":"31","%uD83D%uDE13":"32","%uD83D%uDE1E":"33","%uD83D%uDE16":"34","%uD83D%uDE25":"35","%uD83D%uDE30":"36","%uD83D%uDE28":"37","%uD83D%uDE2B":"38","%uD83D%uDE23":"38","%uD83D%uDE22":"39","%uD83D%uDE2D":"40","%uD83D%uDE32":"41","%uD83D%uDE35":"41","%uD83D%uDE20":"42","%uD83D%uDE21":"43","%uD83D%uDE2A":"44","%uD83D%uDC7F":"45","%uD83D%uDC7D":"46","%u2764":"47","%uD83D%uDC94":"48","%uD83D%uDC98":"49","%u2728":"50","%uD83C%uDF1F":"51","\\ue021":"52","%u2755":"52","%u2754":"53","%uD83D%uDCA4":"54","%uD83D%uDCA6":"55","%uD83C%uDFB5":"56","%uD83D%uDD25":"57","%uD83D%uDCA9":"58","%uD83D%uDC4D":"59","%uD83D%uDC4E":"60","%uD83D%uDC4A":"61","%u270C":"62","%uD83D%uDC46":"63","%uD83D%uDC47":"64","%uD83D%uDC49":"65","%uD83D%uDC48":"66","%u261D":"67","%uD83D%uDC8F":"68","%uD83D%uDC91":"69","%uD83D%uDC66":"70","%uD83D%uDC67":"71","%uD83D%uDC69":"72","%uD83D%uDC68":"73","%uD83D%uDC7C":"74","%uD83D%uDC80":"75","%uD83D%uDC8B":"76","%u2600":"77","%u2614":"78","%u2601":"79","%u26C4":"80","%uD83C%uDF19":"81","%u26A1":"82","%uD83C%uDF0A":"83","%uD83D%uDC31":"84","%uD83D%uDC36":"85","%uD83D%uDC2D":"86","%uD83D%uDC39":"87","%uD83D%uDC30":"88","%uD83D%uDC3A":"89","%uD83D%uDC38":"90","%uD83D%uDC2F":"91","%uD83D%uDC28":"92","%uD83D%uDC3B":"93","%uD83D%uDC37":"94","%uD83D%uDC2E":"95","%uD83D%uDC17":"96","%uD83D%uDC35":"97","%uD83D%uDC34":"98","%uD83D%uDC0D":"99","%uD83D%uDC26":"100","%uD83D%uDC14":"101","%uD83D%uDC27":"102","%uD83D%uDC1B":"103","%uD83D%uDC19":"104","%uD83D%uDC20":"105","%uD83D%uDC33":"106","%uD83D%uDC2C":"107","%uD83C%uDF39":"108","%uD83C%uDF3A":"109","%uD83C%uDF34":"110","%uD83C%uDF35":"111","%uD83D%uDC9D":"112","%uD83C%uDF83":"113","%uD83C%uDF85":"114","%uD83C%uDF84":"115","%uD83D%uDD14":"116","%uD83C%uDF88":"117","%uD83D%uDCBF":"118","%uD83D%uDCF7":"119","%uD83C%uDFA5":"120","%uD83D%uDCBB":"121","%uD83D%uDCFA":"122","%u260E":"123","%uD83D%uDD13":"124","%uD83D%uDD12":"125","%uD83D%uDD11":"126","%uD83D%uDD28":"127","%uD83D%uDCA1":"128","%uD83D%uDCEB":"129","%uD83D%uDEC0":"130","%uD83D%uDCB0":"131","%uD83D%uDCA3":"132","%uD83D%uDD2B":"133","%uD83D%uDC8A":"134","%uD83C%uDFC8":"135","%uD83C%uDFC0":"136","%u26BD":"137","%u26BE":"138","%u26F3":"139","%uD83C%uDFC6":"140","%uD83D%uDC7E":"141","%uD83C%uDFA4":"142","%uD83C%uDFB8":"143","%uD83D%uDC59":"144","%uD83D%uDC51":"145","%uD83C%uDF02":"146","%uD83D%uDC5C":"147","%uD83D%uDC84":"148","%uD83D%uDC8D":"149","%uD83D%uDC8E":"150","%u2615":"151","%uD83C%uDF7A":"152","%uD83C%uDF7B":"153","%uD83C%uDF78":"154","%uD83C%uDF54":"155","%uD83C%uDF5F":"156","%uD83C%uDF5D":"157","%uD83C%uDF63":"158","%uD83C%uDF5C":"159","%uD83C%uDF73":"160","%uD83C%uDF66":"161","%uD83C%uDF82":"162","%uD83C%uDF4E":"163","%u2708":"164","%uD83D%uDE80":"165","%uD83D%uDEB2":"166","%uD83D%uDE84":"167","%u26A0":"168","%uD83C%uDFC1":"169","%uD83D%uDEB9":"170","%uD83D%uDEBA":"171","%u2B55":"172","%u274C":"173","%A9":"174","%AE":"175","%u2122":"176"},Z=/%uD83D%uDE32|%uD83D%uDE22|%uD83D%uDE16|%u2122|%AE|%A9|%u274C|%u2B55|%uD83D%uDEBA|%uD83D%uDEB9|%uD83C%uDFC1|%u26A0|%uD83D%uDE84|%uD83D%uDEB2|%uD83D%uDE80|%u2708|%uD83C%uDF4E|%uD83C%uDF82|%uD83C%uDF66|%uD83C%uDF73|%uD83C%uDF5C|%uD83C%uDF63|%uD83C%uDF5D|%uD83C%uDF5F|%uD83C%uDF54|%uD83C%uDF78|%uD83C%uDF7B|%uD83C%uDF7A|%u2615|%uD83D%uDC8E|%uD83D%uDC8D|%uD83D%uDC84|%uD83D%uDC5C|%uD83C%uDF02|%uD83D%uDC51|%uD83D%uDC59|%uD83C%uDFB8|%uD83C%uDFA4|%uD83D%uDC7E|%uD83C%uDFC6|%u26F3|%u26BE|%u26BD|%uD83C%uDFC0|%uD83C%uDFC8|%uD83D%uDC8A|%uD83D%uDD2B|%uD83D%uDCA3|%uD83D%uDCB0|%uD83D%uDEC0|%uD83D%uDCEB|%uD83D%uDCA1|%uD83D%uDD28|%uD83D%uDD11|%uD83D%uDD12|%uD83D%uDD13|%u260E|%uD83D%uDCFA|%uD83D%uDCBB|%uD83C%uDFA5|%uD83D%uDCF7|%uD83D%uDCBF|%uD83C%uDF88|%uD83C%uDF89|%uD83D%uDD14|%uD83C%uDF81|%uD83C%uDF84|%uD83C%uDF85|%uD83D%uDC7B|%uD83C%uDF83|%uD83D%uDC9D|%uD83C%uDF35|%uD83C%uDF34|%uD83C%uDF3A|%uD83C%uDF39|%uD83D%uDC2C|%uD83D%uDC33|%uD83D%uDC20|%uD83D%uDC19|%uD83D%uDC1B|%uD83D%uDC27|%uD83D%uDC14|%uD83D%uDC26|%uD83D%uDC0D|%uD83D%uDC34|%uD83D%uDC35|%uD83D%uDC17|%uD83D%uDC2E|%uD83D%uDC37|%uD83D%uDC3B|%uD83D%uDC28|%uD83D%uDC2F|%uD83D%uDC38|%uD83D%uDC3A|%uD83D%uDC30|%uD83D%uDC39|%uD83D%uDC2D|%uD83D%uDC36|%uD83D%uDC31|%uD83C%uDF0A|%u26A1|%uD83C%uDF19|%u26C4|%u2601|%u2614|%u2600|%uD83D%uDC8B|%uD83D%uDC80|%uD83D%uDC7C|%uD83D%uDC68|%uD83D%uDC69|%uD83D%uDC67|%uD83D%uDC66|%uD83D%uDC91|%uD83D%uDC8F|%uD83D%uDCAA|%u261D|%uD83D%uDC48|%uD83D%uDC47|%uD83D%uDC49|%uD83D%uDC46|%u270C|%uD83D%uDC4A|%uD83D%uDC4E|%uD83D%uDC4D|%uD83D%uDCA9|%uD83D%uDD25|%uD83C%uDFB5|%uD83D%uDCA6|%uD83D%uDCA4|%u2754|%u2755|%uD83C%uDF1F|%u2728|%uD83D%uDC98|%u2764|%uD83D%uDC94|%uD83D%uDC7D|%uD83D%uDC7F|%uD83D%uDE37|%uD83D%uDE2A|%uD83D%uDE21|%uD83D%uDE20|%uD83D%uDE31|%uD83D%uDE35|%uD83D%uDE02|%uD83D%uDE2D|%uD83D%uDE23|%uD83D%uDE28|%uD83D%uDE30|%uD83D%uDE25|%uD83D%uDE2B|%uD83D%uDE14|%uD83D%uDE13|%uD83D%uDE0F|%uD83D%uDE12|%uD83D%uDE1E|%uD83D%uDE1D|%uD83D%uDE1C|%uD83D%uDE0C|%uD83D%uDE01|%uD83D%uDE04|%uD83D%uDE0A|%uD83D%uDE03|%u263A|%uD83D%uDE09|%uD83D%uDE0D|%uD83D%uDE18|%uD83D%uDE1A|%uD83D%uDE33/gi,ee={"0%u20E3":"1","1%u20E3":"2","2%u20E3":"3","3%u20E3":"4","4%u20E3":"5","5%u20E3":"6","6%u20E3":"7","7%u20E3":"8","8%u20E3":"9","\\ue303":"96","\\ue110":"102","%uD83C%uDF40":"102","9%u20E3":"10"},te=/%uD83C%uDF40|[0-9]%u20E3|\\ue110|\\ue303/gi;function ne(e){var t=/\[[\u4e00-\u9fa5]{1,3}\]|\[\w{1,3}\]/gi,n=e.match(t);if(n){var i,r=Object(f["a"])(n);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(K[a]){var s="qq-face-map qq-face-map-"+K[a];e=e.replace(a,'<div class="'+s+'"></div>')}else if(X[a]){var o="emoji-map emoji-"+X[a];e=e.replace(a,'<div class="'+o+'"></div>')}}}catch(x){r.e(x)}finally{r.f()}}var c=/\\uE[\w]{3}/gi,l=/%ue|%uE/g,d=/%0A/g;e=escape(e).replace(l,"\\ue"),e=e.replace(d,"<br/>");var u=e.match(c);if(u){var h,m=Object(f["a"])(u);try{for(m.s();!(h=m.n()).done;){var p=h.value;if(Y[p]){var C="emoji-map emoji-"+Y[p];e=e.replace(p,'<div class="'+C+'"></div>')}}}catch(x){m.e(x)}finally{m.f()}}var b=e.match(Z);if(b){var g,D=Object(f["a"])(b);try{for(D.s();!(g=D.n()).done;){var v=g.value;if(Y[v]){var F="emoji-map emoji-"+Y[v];e=e.replace(v,'<div class="'+F+'"></div>')}}}catch(x){D.e(x)}finally{D.f()}}var y=e.match(te);if(y){var k,I=Object(f["a"])(y);try{for(I.s();!(k=I.n()).done;){var w=k.value;if(ee[w]){var T="emojis-map emojis-"+ee[w];e=e.replace(w,'<div class="'+T+'"></div>')}}}catch(x){I.e(x)}finally{I.f()}}return e=unescape(e),e}var ie={qqFaceImgMap:ne},re=n("9393"),ae={data:function(){return{size:10,notShow:["System","Sys_LuckyMoney","RoomSystem",5,16,17],revokeMap:["Text","NameCard","Picture","Voice","Video","File","Link","WeApp"],detailDialogVisible:!1,knicking:!1,revoking:!1,memberDialog:!1,memberDetail:{},hb2detail:{}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({currentMode:"currentMode",members:"nedb/members",friends:"nedb/friendsAll",currentChats:"nedb/currentChats",luckMoneyMap:"nedb/luckMoneyMap",detailUrl:"conversation/url",hbDetail:"conversation/hbDetail",atContent:"conversation/content",currentWechat:"conversation/currentWechat",currentFriends:"conversation/currentFriends",currentWeChatId:"conversation/currentWeChatId"})),{},{currentFriend:function(){return this.currentFriends[this.currentWeChatId]||{}},memberMap:function(){var e,t={},n=Object(f["a"])(this.members);try{for(n.s();!(e=n.n()).done;){var i=e.value;t[i.Wxid]=i}}catch(r){n.e(r)}finally{n.f()}return t},friendMap:function(){var e,t={},n=Object(f["a"])(this.friends);try{for(n.s();!(e=n.n()).done;){var i=e.value;t[i.FriendId]=i}}catch(r){n.e(r)}finally{n.f()}return t},chats:function(){var e=[];e=this.currentChats.slice(-this.size);var t,n=Object(f["a"])(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;(new Date).getTime()-i.CreateTime<12e4?i.canRevoke=!0:i.canRevoke=!1}}catch(r){n.e(r)}finally{n.f()}return e},hbDetailVisible:{get:function(){return this.$store.getters["conversation/hbDetailVisible"]},set:function(e){this.$store.commit("conversation/SET_HB_DETAIL_VISIBLE",e),e||(this.$store.commit("conversation/SET_HB_DETAIL",{WeChatId:"",Success:!1,ErrMsg:"",HbUrl:"",TotalNum:null,TotalAmount:null,RecNum:null,Records:[],RecAmount:null}),this.hb2detail={})}}}),methods:{errorHandler:function(){return!0},getAvatar:function(e){if(e.IsSend)return this.currentWechat.Avatar||"";if(e.FriendId.indexOf("@chatroom")>-1){var t=re["a"].decode(e.Content).split(":")[0];return this.friendMap[t]?this.friendMap[t].Avatar:this.memberMap[t]?this.memberMap[t].Avatar:""}return this.currentFriend.Avatar},getMemberName:function(e){var t=re["a"].decode(e).split(":")[0],n=t;return this.friendMap[t]?n=this.friendMap[t].FriendNick:this.memberMap[t]&&(n=this.memberMap[t].Nickname),n},showMemberDetail:function(e){if(this.currentFriend.UserName){var t=re["a"].decode(e.Content).split(":")[0];this.friendMap[t]?this.memberDetail=this.friendMap[t]:this.memberMap[t]?this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:t,Avatar:this.memberMap[t].Avatar?this.memberMap[t].Avatar:"",FriendNick:this.memberMap[t].Nickname?this.memberMap[t].Nickname:"",LabelIds:""}:this.memberDetail={WeChatId:this.currentFriend.WeChatId,FriendId:t,Avatar:"",FriendNick:"",LabelIds:""},this.memberDialog=!0}},addToAddress:function(){var e={WeChatId:this.memberDetail.WeChatId,ChatroomId:this.currentFriend.UserName,FriendId:this.memberDetail.FriendId,Message:"",Remark:""};this.$store.dispatch("websocket/AddFriendInChatRoomTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")},getMemberDetail:function(){var e={wechatId:this.memberDetail.WeChatId,friendId:this.memberDetail.FriendId};this.$store.dispatch("websocket/RequestContactsInfoTask",e),this.memberDialog=!1,this.$message.info("指令已经下发！")},decodeChat:function(e){var t="",i=new RegExp(/^{.+}$/),r={},a="",s="",o="";switch(t=re["a"].decode(e.Content),e.FriendId.indexOf("@chatroom")>0&&(t.startsWith("http")||(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,""))),e.ContentType){case"Text":case 1:return ie.qqFaceImgMap(t);case"Picture":case 2:return"string"===typeof t&&i.test(t)?(r=JSON.parse(t),a=r.Thumb&&r.Thumb.startsWith("http")?r.Thumb:r.Url?r.Url:n("f067")):a=t,s='<img class="chat-img" src="'.concat(a,'" title="点击看大图" alt="图片"/>'),s;case"Voice":case 3:return a=t.endsWith(".amr")?t.replace(/.amr$/,".mp3"):t.replace(/.mp3:[0-9]+/,".mp3"),s=' <audio src="'.concat(a,'" alt="语音" controls></audio>'),s;case"Video":case 4:return"string"===typeof t&&i.test(t)?(r=JSON.parse(t),a=r.Thumb?r.Thumb:n("f067"),s='<img class="chat-img" src="'.concat(a,'"  alt="视频" />\n               <i class="fa fa-play-circle-o fa-2x play-video" aria-hidden="true" title="点击播放"></i>')):(a=t,s='<video class="video-box" src="'.concat(a,'" type="video/mp4" alt="视频"></video>\n               <i class="fa fa-play-circle-o fa-2x play-video" aria-hidden="true" title="点击播放"></i>')),s;case"System":case 5:return re["a"].decode(e.Content);case"Link":case 6:if("string"===typeof t){switch(r=JSON.parse(t),r.TypeStr){case"[链接]":s='\n                        <span class="link-title">'.concat(r.Title,'</span>\n                        <div class="link-content">\n                          <span class="link-des">').concat(r.Des,'</span>\n                          <img class="link-img" src="').concat(r.Thumb,'" alt="链接图片" />\n                        </div>\n                        <div class="link-type">').concat(r.TypeStr,"</div>\n                        ");break;case"[聊天记录]":s='\n                        <span class="link-title">'.concat(r.Title,'</span>\n                        <div class="link-content">\n                         <span class="link-des">').concat(r.Des,'...</span>\n                        </div>\n                        <div class="link-type">').concat(r.TypeStr,"</div>\n                        ");break;default:s=r;break}return s}return t;case"LinkExt":case 7:return"LinkExt消息：".concat(t);case"File":case 8:if("string"===typeof t&&i.test(t)){r=JSON.parse(t);var c=0;r.size&&(c=r.size<1024?r.size+"B":r.size<1048576?parseInt(r.size/1024)+"KB":parseInt(r.size/1048576)+"MB");var l=r.Des?r.Des.replace(/,.*/,""):r.size?c:"",d=r.Title?r.Title:r.name?r.name:"",u=r.Des?r.Des.replace(/.*,/,"").trim():r.name?r.name.replace(/.*\./,""):"",h=r.Source?r.Source:"手机",f="fa-question-circle-o";switch(u){case"doc":case"docx":f="fa-file-word-o";break;case"xls":case"xlsx":f="fa-file-excel-o";break;case"ppt":case"pptx":f="fa-file-powerpoint-o";break;case"zip":case"rar":f="fa-file-archive-o";break;case"text":case"txt":f="fa-file-text-o";break;case"mp3":f="fa-file-sound-o";break;default:f="fa-question-circle-o";break}return s='\n                  <span class="file-title">'.concat(d,'</span>\n                  <div class="file-content">\n                    <span class="file-des">').concat(l,'</span>\n                    <i class="fa ').concat(f,' file-icon" aria-hidden="true"></i>\n                  </div>\n                  <div class="file-type">').concat(h,"</div>\n                "),s}return t;case"NameCard":case 9:return"string"===typeof t&&i.test(t)?(r=JSON.parse(t),a=r.HeadImg?r.HeadImg:"",o=r.Nickname):(a=this.friendMap[t]?this.friendMap[t].Avatar:"",o=this.friendMap[t]?this.friendMap[t].FriendNick:""),s='\n                    <div class="namecard-info">\n                      <img class="namecard-img" src="'.concat(a,'" alt="好友头像" />\n                      <span class="namecard-nickname ellipsis2">').concat(o,'</span>\n                    </div>\n                    <div class="namecard-tip">个人名片</div>\n                  '),s;case"Location":case 10:return"位置消息：".concat(t);case"LuckyMoney":case 11:var m="恭喜发财，大吉大利";"string"===typeof t&&i.test(t)&&(r=JSON.parse(t),m=r.Title);var p=this.luckMoneyMap[e.msgSvrId]?"已领取":"";return s='\n                    <div class="luck-info">\n                      <span class="luck-img" > &nbsp;&nbsp;🧧 </span>\n                      <span class="luck-wish ellipsis2" >'.concat(m,'</span>\n                      <span class="luck-flag ellipsis2" >').concat(p,'</span>\n                    </div>\n                    <div class="luckmoney-tip">微信红包</div>\n                    '),s;case"MoneyTrans":case 12:r="string"===typeof t&&i.test(t)?JSON.parse(t):t;var C="",b=0;switch(r.Feedesc&&(b=r.Feedesc),r.PaySubType){case 1:C=e.IsSend?"转账给".concat(this.currentFriend.FriendNick):"转账给你";break;case 3:C="已收钱";break;default:break}var g=n("decc");if(3===r.PaySubType)s='\n                        <div class="moneytran-info">\n                            <img class="moneytran-img" src="'.concat(g,'" alt />\n                            <span class="moneytran-feed" >').concat(b,'</span>\n                            <span class="moneytran-flag">').concat(C,'</span>\n                            <span class="moneytran-flag"></span>\n                        </div>\n                        <div class="moneytran-tip">微信转账</div>\n                    ');else{var D=this.luckMoneyMap[e.msgSvrId]?"已被领取":"";s='\n                        <div class="moneytran-info">\n                            <img class="moneytran-img" src="'.concat(g,'" alt />\n                            <span class="moneytran-feed" >').concat(b,'</span>\n                            <span class="moneytran-flag">').concat(C,'</span>\n                            <span class="moneytran-flag">').concat(D,'</span>\n                        </div>\n                        <div class="moneytran-tip">微信转账</div>\n                  ')}return s;case"WeApp":case 13:var v=n("f067"),F="无效小程序",y="无效小程序",k="",I="小程序";return"string"===typeof t&&i.test(t)&&(r=JSON.parse(t),v=r.Icon&&"undefined"!==typeof r.Icon?r.Icon:n("f067"),F=r.Source,y=r.Title||r.Des,k=r.Thumb,I=r.TypeStr?r.TypeStr:"小程序"),s='\n                  <div class="app-des">\n                  <img class="app-icon" src="'.concat(v,'" alt="icon" />\n                  <span class="app-source ellipsis">').concat(F,'</span>\n                  </div>\n                  <div class="app-title ellipsis">').concat(y,'</div>\n                  <img class="app-img" src="').concat(k,'" />\n                  <div class="app-typestr">').concat(I,"</div>\n                   "),s;case"Emoji":case 14:var w={"jsb_j.png":"http://emoji.qpic.cn/wx_emoji/abG5b87mcOW7YxBZFZPZOBXUjE99n48g6Znn6zaUiaVRtxMBYaEEKoA/","jsb_s.png":"http://emoji.qpic.cn/wx_emoji/ARQOAfC52Cu6iczyCvLhibUNQxCialTeaeObDoEMsL7uJjyV5dqzCNCFQ/","jsb_b.png":"http://emoji.qpic.cn/wx_emoji/Ty7jp6YeVib7MibicS8eb9buorVCg7mYTFXxuEpVDyQMaqK6PUoOcGxbQ/","dice_1.png":"http://emoji.qpic.cn/wx_emoji/QsDXJwBwXEXGFwLHJCm6haBlFls30vzPQcZTib9dyhLiazKxoPX6kp0A/","dice_2.png":"http://emoji.qpic.cn/wx_emoji/YbCHM38dRYCIWbKmiaBrdnPrfuuwicLD2iacSWaPoAiaFrUySG87ELibOXQ/","dice_3.png":"http://emoji.qpic.cn/wx_emoji/lgVbvPFtzP8ytMiaKZMUoV3BXNPRfUaP69vozHfNarmX3MlTrgOhrkA/","dice_4.png":"http://emoji.qpic.cn/wx_emoji/zaBCJf5hVDn8NlibdrxV4NoPc12d28S7s67UCJqwynRmB0spdttIbeQ/","dice_5.png":"http://emoji.qpic.cn/wx_emoji/72IJJTdBzuibcxvnpFVicUAzCWRJC3cKhtkpMHTFejC2cyOeEGSHibTKw/","dice_6.png":"http://emoji.qpic.cn/wx_emoji/Jowow1icuI3XqtkFeQgIuzjIEYHdtJZictGFJjTsAFwW1g6cx1uTaQfw/"};return w[t]&&(t=w[t]),s='<img class="chat-img" src="'.concat(t,'" title="点击看大图" alt="图片"/>'),s;case"RoomManage":case 15:return"RoomManage";case"Sys_LuckyMoney":case 16:return JSON.parse(re["a"].decode(e.Content)).Title;case"RoomSystem":case 17:return JSON.parse(re["a"].decode(e.Content)).title;case"NotifyMsg":case 21:return r=JSON.parse(t),s='\n                      <span class="link-title">'.concat(r.source,'</span>\n                      <div class="link-content">\n                       <span class="link-des">').concat(r.title,'...</span>\n                      </div>\n                      <div class="link-type">').concat(r.des,"</div>\n                      "),s;case"BizLink":return t;default:return"不支持的消息".concat(e.ContentType,"：").concat(t)}},whatToDo:function(e){switch(e.ContentType){case"Text":case"Voice":case"System":break;case"Picture":case"Video":case"File":this.showDetail(e);break;case"Link":case 6:this.openLink(e);break;case"LuckyMoney":case"MoneyTrans":this.queryHbDetailTask(e);break;case"WeApp":case 13:break;default:break}},setBottom:function(){var e=document.getElementById("show-chat");if(e){var t=document.getElementById("show-chat").scrollHeight,n=document.getElementById("show-chat").clientHeight;document.getElementById("show-chat").scrollTop=t-n}},newPage:function(){var e=document.getElementById("show-chat").scrollTop,t=document.getElementById("show-chat").scrollHeight,n=document.getElementById("show-chat").clientHeight;0===e&&t>n&&(this.size<this.currentChats.length?(this.size=this.size+1,setTimeout((function(){document.getElementById("show-chat").scrollTop=5}),100)):this.$message.warning("没有更多数据！"))},showDetail:function(e){var t="",n=new RegExp(/^{.+}$/),i="";if(t=re["a"].decode(e.Content),e.FriendId.indexOf("@chatroom")>0&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&n.test(t)&&(t=JSON.parse(t)),"object"===Object(J["a"])(t)&&(t.Url||t.url)?i=t.Url||t.url:"string"===typeof t&&(i=t),i)this.$store.commit("conversation/SET_URL",i);else{var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);r["Content"]=t,this.$store.dispatch("websocket/RequestTalkDetailTask",r)}this.detailDialogVisible=!0},handleDeatilClose:function(e){this.$store.commit("conversation/SET_URL",""),e()},openLink:function(e){var t="",n=new RegExp(/^{.+}$/);if(t=re["a"].decode(e.Content),e.FriendId.indexOf("@chatroom")>0&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&n.test(t)){var i=JSON.parse(t);switch(i.TypeStr){case"[链接]":if("邀请你加入群聊"===i.Title||"邀请您加入群聊"===i.Title){var r={WeChatId:e.WeChatId,Talker:e.FriendId,MsgSvrId:e.msgSvrId,MsgContent:JSON.stringify(i)};this.$store.dispatch("websocket/AgreeJoinChatRoomTask",r)}else{var a=i.Url;if("electron"===this.currentMode){var s=window.require("electron"),o=s.shell;o.openExternal(a)}else{var c=document.createElement("a");c.setAttribute("href",a),c.setAttribute("target","_blank"),c.setAttribute("id","js_a"),document.getElementById("js_a")&&document.body.removeChild(document.getElementById("js_a")),document.body.appendChild(c),c.click()}}break;case"[聊天记录]":break;default:break}}},queryHbDetailTask:function(e){this.hb2detail=e;var t="",n=new RegExp(/^{.+}$/);t=re["a"].decode(e.Content),e.FriendId.indexOf("@chatroom")>0&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&n.test(t)&&(t=JSON.parse(t)),t.Key&&e.WeChatId&&(this.$store.dispatch("websocket/QueryHbDetailTask",{WeChatId:e.WeChatId,HbUrl:t.Key}),this.$message({type:"info",message:"正在获取红包详情！",duration:1e3}))},takeLuckMoney:function(e){console.log(e);var t="",n=new RegExp(/^{.+}$/);if(t=re["a"].decode(e.Content),e.FriendId.indexOf("@chatroom")>0&&(t=t.replace(/\S+?:/,"").replace(/^\n+|\n+$/g,"")),"string"===typeof t&&n.test(t)){var i=JSON.parse(t),r=parseInt((new Date).getTime()/1e3);if(e.IsSend){if(i.PaySubType&&3===i.PaySubType)return}else if(this.luckMoneyMap[e.msgSvrId]){if("LuckyMoney"===e.ContentType){var a=0;a="￥："+this.luckMoneyMap[e.msgSvrId].Amount,this.$alert("金额"+a+" 分","已经打开",{confirmButtonText:"确定",callback:function(e){return!0}})}}else{if("MoneyTrans"===e.ContentType&&3===i.PaySubType)return;if(r-t.InvalidTime>=86400)this.$message.warning("已过期");else{var s={WeChatId:e.WeChatId,FriendId:e.FriendId,MsgSvrId:e.MsgSvrId?e.MsgSvrId:e.msgSvrId,MsgKey:i.Key};this.$store.dispatch("websocket/TakeLuckyMoneyTask",s)}}}},canTransform:function(e){var t=[1,2,3,6,13,"Text","Picture","Voice","Link","WeApp"];this.$message.info("改功能待实现！"),t.indexOf(e.ContentType)},revokeMessageTask:function(e){var t=this;(new Date).getTime()-e.CreateTime>=12e4?this.$message.warning("消息发出超过2分钟，不能测回！"):(this.revoking=!0,setTimeout((function(){t.revoking=!1}),2e3),this.$store.dispatch("websocket/RevokeMessageTask",e))},atSomebody:function(e){var t=re["a"].decode(e.Content).split(":")[0],n=this.getMemberName(e.Content);this.currentFriend.MemberList.indexOf(t)<0?this.$message.warning("该成员已经不在群里！"):(this.$store.commit("conversation/SET_REMARK",t),this.$store.commit("conversation/SET_CONTENT","".concat(this.atContent,"@").concat(n," ")))},knickSomeBody:function(e){var t=this,n=re["a"].decode(e.Content).split(":")[0],i=this.getMemberName(e.Content);this.currentFriend.MemberList.indexOf(n)<0?this.$message.warning("该成员已经不在群里！"):this.$confirm("是否确认删除成员 ".concat(i," ?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.knicking=!0;var e={WeChatId:t.currentWeChatId,ChatRoomId:t.currentFriend.UserName,Action:3,Content:n};t.$store.dispatch("websocket/ChatRoomActionTask",e),setTimeout((function(){t.knicking=!1}),2e3)})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},rightEvent:function(e,t){var n=e.pageY,i=e.pageX;this.chatChose=t,this.showRight=!1;var r=document.getElementById("chatRightEvents");r.style.top=n+"px",r.style.left=i+"px",this.showRight=!0},hideRight:function(){this.showRight=!1,this.showAt=!1}},watch:{currentFriend:function(e){var t=this;setTimeout((function(){t.setBottom()}),100),this.size=10,this.$store.dispatch("nedb/SetCurrentChats","{}"!==JSON.stringify(e)&&e.FriendId?e.FriendId:e.UserName)}},mounted:function(){}},se=ae,oe=(n("fdc1"),Object(C["a"])(se,Q,G,!1,null,"57a9333d",null)),ce=oe.exports,le={data:function(){return{}},components:{ToolsBar:j,AnswerWindow:H,ShowChats:ce},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({currentFriends:"conversation/currentFriends",currentWeChatId:"conversation/currentWeChatId"})),{},{currentFriend:function(){return this.currentFriends[this.currentWeChatId]||{}}}),methods:{}},de=le,ue=(n("f7be"),Object(C["a"])(de,a,s,!1,null,"2898b532",null)),he=ue.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-friends"},[n("div",{staticClass:"friends-title"},[n("span",{staticClass:"tab can-not-select",class:{"tab-chose":"LastChat"===e.currentTab},on:{click:function(t){return e.setTab("LastChat")}}},[e._v("会话")]),n("span",{staticClass:"tab can-not-select",class:{"tab-chose":"AddressList"===e.currentTab},on:{click:function(t){return e.setTab("AddressList")}}},[e._v("通讯录")]),n("span",{staticClass:"tab can-not-select",class:{"tab-chose":"ChatRoom"===e.currentTab},on:{click:function(t){return e.setTab("ChatRoom")}}},[e._v("群聊")])]),n("div",{staticClass:"search-box"},[n("el-input",{staticClass:"search-input",attrs:{"prefix-icon":"el-icon-search",type:"text",placeholder:"请输入内容",maxlength:"20","show-word-limit":""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchChange(t)}},model:{value:e.searchInfo,callback:function(t){e.searchInfo=t},expression:"searchInfo"}})],1),n("div",{staticClass:"friends-content scroll"},[e._l(e.currentInfo[e.currentPage],(function(t,i){return n("div",{key:i,staticClass:"friend-info",class:{selected:"AddressList"===e.currentTab?e.currentChose===t.FriendId:e.currentChose===t.UserName},on:{click:function(n){return e.choseFriend(t)}}},[n("div",{staticClass:"avatar-tip"},[n("img",{staticClass:"img",attrs:{src:e.getAvatar(t),alt:"好友头像"}}),"LastChat"===e.currentTab&&t.UnreadCnt&&t.UnreadCnt>0?n("div",{staticClass:"tip",attrs:{title:t.UnreadCnt},domProps:{textContent:e._s(t.UnreadCnt<99?t.UnreadCnt:"...")}}):e._e()]),n("div",{staticClass:"nick-content"},[n("div",{staticClass:"friend-nick ellipsis",domProps:{textContent:e._s(e.getNickName(t))}}),"LastChat"===e.currentTab?n("div",{staticClass:"chat-content ellipsis",domProps:{textContent:e._s(t.Digest?t.UserName.indexOf("@chatroom")>=0?t.IsSend?t.Digest:t.Digest.replace("%s:",""):t.Digest:"")}}):e._e()]),n("div",{staticClass:"time-disturb"},["LastChat"===e.currentTab?n("div",{domProps:{textContent:e._s(e.$options.filters.transformTime(t.UpdateTime))}}):e._e(),n("div",{staticClass:"opration-btns"},["notifymessage"!==t.UserName?n("i",{staticClass:"fa fa-retweet sigle-fresh",attrs:{"aria-hidden":"true"},on:{click:function(n){return n.stopPropagation(),e.getFriendDetail(t)}}}):e._e(),"AddressList"===e.currentTab?n("i",{staticClass:"el-icon-delete sigle-fresh",on:{click:function(n){return n.stopPropagation(),e.deleteChat(t)}}}):e._e()])])])})),0===e.currentInfo.length&&"Search"===e.currentTab?[n("div",{staticClass:"current-info-null"},[e._v("搜索不到结果！")])]:e._e()],2),n("div",{staticClass:"friends-bottom"},[n("el-tooltip",{attrs:{effect:"dark",content:e.currentTitle[e.currentTab],placement:"top-start"}},[n("el-button",{attrs:{type:"text"},domProps:{textContent:e._s(e.counts)}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"上一页",placement:"top-start"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-arrow-left",disabled:0===e.currentPage},on:{click:function(t){return e.changePage(-1)}}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"当前页",placement:"top-start"}},[n("el-button",{attrs:{type:"text"},domProps:{textContent:e._s(e.currentPage+1)}})],1),n("el-divider",{attrs:{direction:"vertical"}}),n("el-tooltip",{attrs:{effect:"dark",content:"总页数",placement:"top-start"}},[n("el-button",{attrs:{type:"text"},domProps:{textContent:e._s(e.maxPage)}})],1),n("el-tooltip",{attrs:{effect:"dark",content:"下一页",placement:"top-start"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-arrow-right",disabled:e.currentPage+1===e.maxPage},on:{click:function(t){return e.changePage(1)}}})],1),n("el-tooltip",{attrs:{effect:"dark",content:e.freshTitle[e.currentTab],placement:"top-start"}},[n("el-button",{staticStyle:{color:"#fff"},attrs:{type:"text",icon:"el-icon-refresh",loading:e.freshDisabled},on:{click:function(t){return e.fresh(e.currentTab)}}})],1),n("el-tooltip",{attrs:{effect:"dark",content:e.deleteTitle[e.currentTab],placement:"top-start"}},[n("el-button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return e.removeData(e.currentTab)}}})],1)],1)])},me=[],pe={data:function(){return{currentTitle:{LastChat:"会话数量",AddressList:"好友数量",ChatRoom:"群聊数量"},freshTitle:{LastChat:"刷新会话列表",AddressList:"刷新好友列表",ChatRoom:"刷新群聊列表"},deleteTitle:{LastChat:"清空会话列表",AddressList:"清空好友列表",ChatRoom:"清空群聊列表和陌生人列表"},searchInfo:"",searchResult:[],showRight:!1,chatToDel:{}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({friends:"nedb/friends",friendsAll:"nedb/friendsAll",chatRooms:"nedb/chatRooms",chatRoomsAll:"nedb/chatRoomsAll",conversations:"nedb/conversations",ghMap:"conversation/ghMap",currentTab:"conversation/currentTab",chatRoomPages:"conversation/chatRoomPages",currentWechat:"conversation/currentWechat",freshDisabled:"conversation/freshDisabled",lastChatPages:"conversation/lastChatPages",currentFriends:"conversation/currentFriends",currentWeChatId:"conversation/currentWeChatId",addressListPages:"conversation/addressListPages"})),{},{ghList:function(){return this.ghMap[this.currentWeChatId]?this.ghMap[this.currentWeChatId]:[]},currentInfo:function(){switch(this.currentTab){case"LastChat":return this.conversations;case"AddressList":return this.friends;case"ChatRoom":return this.chatRooms;case"Search":return this.searchResult;default:return[]}},currentChose:function(){return this.currentFriends[this.currentWeChatId]?this.currentFriends[this.currentWeChatId].FriendId||this.currentFriends[this.currentWeChatId].UserName:""},currentPage:function(){switch(this.currentTab){case"LastChat":return this.lastChatPages[this.currentWeChatId]||0;case"AddressList":return this.addressListPages[this.currentWeChatId]||0;case"ChatRoom":return this.chatRoomPages[this.currentWeChatId]||0;default:return 0}},counts:function(){var e=0;if("object"===Object(J["a"])(this.currentInfo)){var t,n=Object(f["a"])(this.currentInfo);try{for(n.s();!(t=n.n()).done;){var i=t.value;e+=i.length}}catch(r){n.e(r)}finally{n.f()}}return e},maxPage:function(){return"object"===Object(J["a"])(this.currentInfo)?0===this.currentInfo.length?1:this.currentInfo.length:1},conversMap:function(){var e={};if(this.friends.length>0){var t,n=Object(f["a"])(this.friends);try{for(n.s();!(t=n.n()).done;){var i,r=t.value,a=Object(f["a"])(r);try{for(a.s();!(i=a.n()).done;){var s=i.value;e[s.FriendId]=s}}catch(m){a.e(m)}finally{a.f()}}}catch(m){n.e(m)}finally{n.f()}}if(this.chatRooms.length>0){var o,c=Object(f["a"])(this.chatRooms);try{for(c.s();!(o=c.n()).done;){var l,d=o.value,u=Object(f["a"])(d);try{for(u.s();!(l=u.n()).done;){var h=l.value;e[h.UserName]=h}}catch(m){u.e(m)}finally{u.f()}}}catch(m){c.e(m)}finally{c.f()}}return e}}),watch:{searchInfo:function(e){this.debounceInput()}},created:function(){this.getFriendDetail=this._.throttle(this.getFriendDetail,2e3),this.debounceInput=this._.debounce(this.debounceInput,500)},methods:{debounceInput:function(){if(this.searchInfo){var e,t=[],n=Object(f["a"])(this.friendsAll);try{for(n.s();!(e=n.n()).done;){var i=e.value;(i.FriendNick&&i.FriendNick.indexOf(this.searchInfo)>=0||i.Memo&&i.Memo.indexOf(this.searchInfo)>=0||i.Phone&&i.Phone.indexOf(this.searchInfo)>=0)&&t.push(i)}}catch(c){n.e(c)}finally{n.f()}var r,a=Object(f["a"])(this.chatRoomsAll);try{for(a.s();!(r=a.n()).done;){var s=r.value;(s.NickName&&s.NickName.indexOf(this.searchInfo)>=0||s.Remark&&s.Remark.indexOf(this.searchInfo)>=0)&&t.push(s)}}catch(c){a.e(c)}finally{a.f()}if(0===t.length)this.searchResult=[];else for(var o=0;o<t.length;o+=50)this.searchResult.push(t.slice(o,o+50));this.$store.commit("conversation/SET_CURRENT_TAB","Search")}else this.searchResult=[],this.$store.commit("conversation/SET_CURRENT_TAB","LastChat")},getNickName:function(e){if("notifymessage"===e.UserName)return"服务通知";var t=e.FriendId||e.UserName;if(this.conversMap[t])return-1===t.indexOf("@chatroom")?this.conversMap[t].Memo||this.conversMap[t].FriendNick:this.conversMap[t].Remark||this.conversMap[t].NickName;var n,i=Object(f["a"])(this.ghList);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.Username===e.UserName)return r.Nickname||r.Alias}}catch(a){i.e(a)}finally{i.f()}return t},getAvatar:function(e){if("notifymessage"===e.UserName)return n("cee5");var t=e.FriendId||e.UserName;if(this.conversMap[t]&&this.conversMap[t].Avatar)return this.conversMap[t].Avatar;var i,r=Object(f["a"])(this.ghList);try{for(r.s();!(i=r.n()).done;){var a=i.value;if(a.Username===e.UserName)return a.Avatar||a.Icon}}catch(s){r.e(s)}finally{r.f()}return n("f067")},setTab:function(e){e!==this.currentTab&&(this.searchInfo="",this.$store.commit("conversation/SET_CURRENT_TAB",e))},fresh:function(e){var t=this;if(this.currentWeChatId)switch(this.$store.commit("conversation/SET_FRESH_DISABLED",!0),e){case"LastChat":this.$store.dispatch("websocket/TriggerConversationPushTask"),setTimeout((function(){t.$store.commit("conversation/SET_FRESH_DISABLED",!1)}),3e3);break;case"AddressList":this.removeData("AddressList"),this.$store.dispatch("websocket/TriggerFriendPushTask");break;default:this.$store.dispatch("nedb/RemoveAllRoomByWechatId",this.currentWechat.WeChatId),this.$store.dispatch("websocket/TriggerChatroomPushTask",this.currentWeChatId);break}else this.$message({message:"请先选中微信",type:"warning"})},deleteChat:function(e){var t=this;switch(this.currentTab){case"LastChat":this.$message({type:"info",message:"从本地删除本地会话，待实现！",duration:1e3});break;case"AddressList":this.$confirm("此操作将删除该好友, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("websocket/DeleteFriendTask",e),t.$message({type:"info",message:"正在删除!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}));break;case"ChatRoom":this.$message({type:"info",message:"从本地删除群聊，待实现！",duration:1e3});break;default:break}},removeData:function(e){if(this.currentWeChatId)switch(e){case"LastChat":this.$store.dispatch("nedb/RemoveAllConversationsByWechatId",this.currentWechat.WeChatId);break;case"AddressList":this.$store.dispatch("nedb/RemoveAllFriensByWechatId",this.currentWechat.WeChatId);break;case"ChatRoom":this.$store.dispatch("nedb/RemoveAllRoomByWechatId",this.currentWechat.WeChatId),this.$store.dispatch("nedb/RemoveMembersByWechatId",this.currentWechat.WeChatId);break;default:break}else this.$message({message:"请先选中微信",type:"warning"})},changePage:function(e){var t=this.currentPage+e;if(t>=0&&t<this.maxPage){var n={wechatId:this.currentWeChatId,page:t};switch(this.currentTab){case"LastChat":this.$store.commit("conversation/SET_LAST_CHAT_PAGES",n);break;case"AddressList":this.$store.commit("conversation/SET_ADDRESS_LIST_PAGES",n);break;case"ChatRoom":this.$store.commit("conversation/SET_CHAT_ROOM_PAGES",n);break;default:break}}},getFriendDetail:function(e){var t={wechatId:this.currentWeChatId,friendId:e.UserName||e.FriendId};if(t.friendId.indexOf("@chatroom")>0){var n=[];e.MemberList?n=e.MemberList:this.conversMap[t.friendId]&&(n=this.conversMap[t.friendId].MemberList),n.length>0&&n.indexOf(this.currentWeChatId)<0?this.$message.warning("你已经不在群里，无法获取群详细信息！"):(this.$store.dispatch("websocket/RequestChatRoomInfoTask",t),this.$message.info("指令已经下发！"))}else this.$store.dispatch("websocket/RequestContactsInfoTask",t),this.$message.info("指令已经下发！")},choseFriend:function(e){var t={},i=e.FriendId||e.UserName;if("LastChat"===this.currentTab){if("notifymessage"===e.UserName)t={Avatar:n("cee5"),NickName:"服务通知",FriendId:e.UserName,WeChatId:e.WeChatId||this.currentWeChatId};else if(this.conversMap[i])t=this.conversMap[i];else{var r,a=Object(f["a"])(this.ghList);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.Username===e.UserName){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o]);s.Avatar||(t.Avatar=s.Icon),t.WeChatId=this.currentWeChatId,t.NickName=s.Nickname,t.FriendId=e.UserName,t.isGh=!0;break}}}catch(d){a.e(d)}finally{a.f()}}if(e.UnreadCnt&&e.UnreadCnt>0){var c={WeChatId:this.currentWeChatId,FriendId:i};this.$store.dispatch("nedb/SetUnreadCnt",c),this.$store.dispatch("websocket/TriggerMessageReadTask",c)}}else t=e;if("{}"!==JSON.stringify(t)){var l={wechatId:this.currentWeChatId,friend:t};this.$store.commit("conversation/SET_CURRENT_FRIENDS",l),e.UpdateTime&&(t.UpdateTime=e.UpdateTime),t.isGh||this.$store.dispatch("nedb/QueryLastChat",t)}else this.getFriendDetail(e)},getHistoryMessageList:function(e,t){if(""!==e){var n={MsgType:"HistoryMessageList",Content:{cid:Number(this.currentUser.SupplierId),wechatid:e,startTime:t}};this.$websocket.sendSock(n)}},queryHistoryMessage:function(e,t,n,i){if(""!==e&&""!==t){var r={MsgType:"QueryHistoryMessage",Content:{cid:Number(this.currentUser.SupplierId),wechatid:e,friendId:t,pageSize:n>=1?n:1,pageNo:i>=1?i:1}};this.$websocket.sendSock(r)}}}},Ce=pe,be=(n("8010"),Object(C["a"])(Ce,fe,me,!1,null,"02ee318e",null)),ge=be.exports,De=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"conversation-tools"},[e._m(0),n("div",{staticClass:"tools-content"},[n("fast-reply")],1),n("div",{staticClass:"tools-bottom"})])},ve=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tools-title"},[n("span",[e._v("快捷语")])])}],Fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fast-reply"},[n("el-radio-group",{staticClass:"reply-nav",attrs:{fill:"#66B1FF"},model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[n("el-radio-button",{attrs:{label:"common"}},[e._v("公共术语")]),n("el-radio-button",{attrs:{label:"my"}},[e._v("我的术语")])],1),n("div",{staticClass:"common-replys scroll"},[e._l(e.groups,(function(t,i){return n("div",{key:i,staticClass:"common-groups"},[n("div",{staticClass:"common-groups-tname"},[n("span",{staticClass:"ellipsis",domProps:{textContent:e._s(i)}}),"my"===e.currentTab?n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"},on:{click:function(t){return e.addReply(i)}}}):e._e(),n("i",{staticClass:"fa fa-chevron-circle-down",attrs:{title:"显示/收起","aria-hidden":"true"},on:{click:function(t){return e.toggleCommonList(i)}}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:-1===e.showGroups.indexOf(i),expression:"showGroups.indexOf(index)===-1"}]},e._l(t,(function(t,i){return n("div",{key:i,staticClass:"every-reply",on:{click:function(n){return e.sendMsg(t)}}},[n("div",{staticClass:"cp-name"},[n("span",{staticClass:"cpname ellipsis",domProps:{textContent:e._s(t.name)}}),"my"===e.currentTab?n("i",{staticClass:"fa fa-minus remove",attrs:{"aria-hidden":"true"},on:{click:function(n){return n.stopPropagation(),e.removeReply(t)}}}):e._e(),n("div",{staticClass:"show-cp",on:{click:function(n){return n.stopPropagation(),e.showCp(t)}}},[e.currentId!==t.id&&5!==t.ctype?n("i",{staticClass:"fa fa-eye-slash",attrs:{"aria-hidden":"true"}}):e._e(),e.currentId===t.id&&5!==t.ctype?n("i",{staticClass:"fa fa-eye",attrs:{"aria-hidden":"true"}}):e._e()])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.id===e.currentId||t._id===e.currentId,expression:"cp.id === currentId || cp._id === currentId"}],staticClass:"reply-detail"},[1===t.ctype?n("p",{domProps:{textContent:e._s(t.content)}}):2===t.ctype?n("img",{attrs:{src:t.content,alt:"图片"}}):3===t.ctype?n("video",{attrs:{src:t.content,controls:""}}):4===t.ctype?n("audio",{attrs:{src:t.content,controls:""}}):e._e()])])})),0)])})),"my"===e.currentTab&&0===e.myReply.length?n("el-button",{staticClass:"add-my-reply",attrs:{type:"primary",size:"small"},on:{click:function(t){e.addReplyVisible=!0}}},[e._v("添加")]):e._e()],2),n("el-dialog",{attrs:{title:"添加常用语",visible:e.addReplyVisible},on:{"update:visible":function(t){e.addReplyVisible=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"60px"}},[n("el-form-item",{attrs:{label:"组名",prop:"tname"}},[n("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.tname,callback:function(t){e.$set(e.ruleForm,"tname",t)},expression:"ruleForm.tname"}})],1),n("el-form-item",{attrs:{label:"备注",prop:"name"}},[n("el-input",{attrs:{maxlength:"20","show-word-limit":""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n("el-form-item",{attrs:{label:"内容",prop:"content"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},maxlength:"500","show-word-limit":""},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),n("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)],1)},ye=[],ke={name:"FastReply",data:function(){return{currentTab:"common",currentId:-1,showGroups:[],addReplyVisible:!1,ruleForm:{ctype:1,tname:"",name:"",content:""},rules:{tname:[{required:!0,message:"请输入组名",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入备注",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"},{min:1,max:500,message:"长度在 1 到 500 个字符",trigger:"blur"}]}}},computed:Object(o["a"])(Object(o["a"])({},Object(c["b"])({publicReply:"conversation/publicReply",myReply:"nedb/myReply"})),{},{groups:function(){var e={},t="common"===this.currentTab?this.publicReply:this.myReply;if(this.publicReply.length>0){var n,i=Object(f["a"])(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(e[r.tname])e[r.tname].push(r);else{var a=[];a.push(r),e[r.tname]=a}}}catch(s){i.e(s)}finally{i.f()}}return e}}),methods:{toggleCommonList:function(e){var t=this.showGroups.indexOf(e);-1===t?this.showGroups.push(e):this.showGroups.splice(t,1)},showCp:function(e){var t=e.id||e._id;this.currentId===t?this.currentId=-1:this.currentId=e.id?e.id:e._id},sendMsg:function(e){var t="Text";switch(e.ctype){case 1:t="Text";break;case 2:t="Picture";break;case 3:t="Video";break;case 4:t="Voice";break;case 5:t="File";break;default:t="Text";break}var n=e.content;if("File"===t){var i=e.name+e.content.replace(/.*\./,".");n=JSON.stringify({name:i,url:e.content,size:"",Source:"公共术语"})}this.$store.commit("conversation/SET_CONTENT_TYPE",t),this.$store.commit("conversation/SET_CONTENT",n)},addReply:function(e){this.ruleForm.tname=e,this.addReplyVisible=!0},removeReply:function(e){this.$store.dispatch("nedb/RemoveMyReply",e._id)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var n={ctype:t.ruleForm.ctype,tname:t.ruleForm.tname,name:t.ruleForm.name,content:t.ruleForm.content,createTime:(new Date).getTime()};t.$store.dispatch("nedb/AddMyReply",n),t.addReplyVisible=!1,t.resetForm("ruleForm")}))},resetForm:function(e){this.$refs[e].resetFields()}},created:function(){0===this.publicReply.length&&this.$store.dispatch("websocket/GetCommonTerms"),0===this.myReply.length&&this.$store.dispatch("nedb/SetMyReply")}},Ie=ke,we=(n("8f66"),Object(C["a"])(Ie,Fe,ye,!1,null,"42475ceb",null)),Te=we.exports,xe={data:function(){return{}},components:{FastReply:Te},computed:{},methods:{fresh:function(e){},clearNedb:function(e){}}},_e=xe,Me=(n("c1e5"),Object(C["a"])(_e,De,ve,!1,null,"002161e6",null)),$e=Me.exports,Ee={name:"MainConversation",data:function(){return{routerViewName:"conversation"}},components:{ConversationFriends:ge,ConversationChats:he,ConversationTools:$e}},Se=Ee,Ne=(n("cd87"),Object(C["a"])(Se,i,r,!1,null,"616a5582",null));t["default"]=Ne.exports},7697:function(e,t,n){"use strict";var i=n("c318"),r=n.n(i);r.a},8010:function(e,t,n){"use strict";var i=n("b303"),r=n.n(i);r.a},"841c":function(e,t,n){"use strict";var i=n("d784"),r=n("825a"),a=n("1d80"),s=n("129f"),o=n("14c3");i("search",1,(function(e,t,n){return[function(t){var n=a(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var a=r(e),c=String(this),l=a.lastIndex;s(l,0)||(a.lastIndex=0);var d=o(a,c);return s(a.lastIndex,l)||(a.lastIndex=l),null===d?-1:d.index}]}))},"8a79":function(e,t,n){"use strict";var i=n("23e7"),r=n("06cf").f,a=n("50c4"),s=n("5a34"),o=n("1d80"),c=n("ab13"),l=n("c430"),d="".endsWith,u=Math.min,h=c("endsWith"),f=!l&&!h&&!!function(){var e=r(String.prototype,"endsWith");return e&&!e.writable}();i({target:"String",proto:!0,forced:!f&&!h},{endsWith:function(e){var t=String(o(this));s(e);var n=arguments.length>1?arguments[1]:void 0,i=a(t.length),r=void 0===n?i:u(a(n),i),c=String(e);return d?d.call(t,c,r):t.slice(r-c.length,r)===c}})},"8ba4":function(e,t,n){var i=n("23e7"),r=n("5e89");i({target:"Number",stat:!0},{isInteger:r})},"8f66":function(e,t,n){"use strict";var i=n("4132"),r=n.n(i);r.a},"8f9d":function(e,t,n){e.exports=n.p+"static/img/tool-bar-clear-data.svg"},9723:function(e,t,n){e.exports=n.p+"static/img/tool-bar-files.svg"},a623:function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").every,a=n("a640"),s=n("ae40"),o=a("every"),c=s("every");i({target:"Array",proto:!0,forced:!o||!c},{every:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},a9a0:function(e,t,n){e.exports=n.p+"static/img/tool-bar-create-room.svg"},ab13:function(e,t,n){var i=n("b622"),r=i("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(i){}}return!1}},ac78:function(e,t,n){},ac80:function(e,t,n){},af6b:function(e,t,n){"use strict";var i=n("ed7b"),r=n.n(i);r.a},affb:function(e,t,n){e.exports=n.p+"static/img/tool-bar-friend-cirlce.svg"},b303:function(e,t,n){},b39b:function(e,t,n){"use strict";var i=n("1a0b"),r=n.n(i);r.a},c1e5:function(e,t,n){"use strict";var i=n("ccbf"),r=n.n(i);r.a},c318:function(e,t,n){},ccbf:function(e,t,n){},cd87:function(e,t,n){"use strict";var i=n("456b"),r=n.n(i);r.a},cd8b:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n(e.$store.getters["currentNavs"][e.$route.name],{tag:"component"})],1)},r=[],a=(n("d3b7"),function(){return n.e("groupAssistant").then(n.bind(null,"afa5"))}),s=function(){return n.e("groupAssistant").then(n.bind(null,"464e"))},o={data:function(){return{}},components:{groupLog:a,groupSend:s}},c=o,l=n("2877"),d=Object(l["a"])(c,i,r,!1,null,"64e425d2",null);t["default"]=d.exports},cee5:function(e,t,n){e.exports=n.p+"static/img/conversation-notify-message.svg"},d029:function(e,t,n){e.exports=n.p+"static/img/tool-bar-transfer-money.svg"},d9e1:function(e,t,n){e.exports=n.p+"static/img/tool-bar-shear.svg"},dde4:function(e,t,n){e.exports=n.p+"static/img/tool-bar-applet.svg"},de5b:function(e,t,n){"use strict";var i=n("0c22"),r=n.n(i);r.a},decc:function(e,t,n){e.exports=n.p+"static/img/conversation-transfer-money.svg"},eb69:function(e,t,n){"use strict";var i=n("ac80"),r=n.n(i);r.a},ed7b:function(e,t,n){},f6d6:function(e,t,n){var i=n("23e7"),r=n("23cb"),a=String.fromCharCode,s=String.fromCodePoint,o=!!s&&1!=s.length;i({target:"String",stat:!0,forced:o},{fromCodePoint:function(e){var t,n=[],i=arguments.length,s=0;while(i>s){if(t=+arguments[s++],r(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},f7be:function(e,t,n){"use strict";var i=n("55f4"),r=n.n(i);r.a},fdc1:function(e,t,n){"use strict";var i=n("ac78"),r=n.n(i);r.a}}]);